/*! kdbxweb v2.1.1, (c) 2021 Antelle, opensource.org/licenses/MIT */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("crypto"),require("@xmldom/xmldom")):"function"==typeof define&&define.amd?define(["crypto","@xmldom/xmldom"],t):"object"==typeof exports?exports.kdbxweb=t(require("crypto"),require("@xmldom/xmldom")):e.kdbxweb=t(e.crypto,e["@xmldom/xmldom"])}(this,(function(e,t){return(()=>{"use strict";var r={61:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ChaCha20=void 0;function r(e,t,r,n,s){e[t]+=e[r],e[s]=i(e[s]^e[t],16),e[n]+=e[s],e[r]=i(e[r]^e[n],12),e[t]+=e[r],e[s]=i(e[s]^e[t],8),e[n]+=e[s],e[r]=i(e[r]^e[n],7)}function n(e,t){return e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24}function s(e,t,r){e[t]=r,r>>>=8,e[t+1]=r,r>>>=8,e[t+2]=r,r>>>=8,e[t+3]=r}function i(e,t){return e<<t|e>>>32-t}t.ChaCha20=class{constructor(e,t){this._sigmaWords=[1634760805,857760878,2036477234,1797285236],this._block=new Uint8Array(64),this._blockUsed=64,this._x=new Uint32Array(16);const r=new Uint32Array(16);r[0]=this._sigmaWords[0],r[1]=this._sigmaWords[1],r[2]=this._sigmaWords[2],r[3]=this._sigmaWords[3],r[4]=n(e,0),r[5]=n(e,4),r[6]=n(e,8),r[7]=n(e,12),r[8]=n(e,16),r[9]=n(e,20),r[10]=n(e,24),r[11]=n(e,28),r[12]=0,12===t.length?(r[13]=n(t,0),r[14]=n(t,4),r[15]=n(t,8)):(r[13]=0,r[14]=n(t,0),r[15]=n(t,4)),this._input=r}getBytes(e){const t=new Uint8Array(e);for(let r=0;r<e;r++)64===this._blockUsed&&(this.generateBlock(),this._blockUsed=0),t[r]=this._block[this._blockUsed],this._blockUsed++;return t}generateBlock(){const e=this._input,t=this._x,n=this._block;t.set(e);for(let e=20;e>0;e-=2)r(t,0,4,8,12),r(t,1,5,9,13),r(t,2,6,10,14),r(t,3,7,11,15),r(t,0,5,10,15),r(t,1,6,11,12),r(t,2,7,8,13),r(t,3,4,9,14);for(let r=16;r--;)t[r]+=e[r];for(let e=16;e--;)s(n,4*e,t[e]);e[12]+=1,e[12]||(e[13]+=1)}encrypt(e){const t=e.length,r=new Uint8Array(t);let n=0;const s=this._block;for(;n<t;){this.generateBlock();const i=Math.min(t-n,64);for(let t=0;t<i;t++)r[n]=e[n]^s[t],n++}return r}}},613:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setArgon2Impl=t.argon2=t.Argon2TypeArgon2id=t.Argon2TypeArgon2d=t.chacha20=t.random=t.createAesCbc=t.AesCbc=t.hmacSha256=t.sha512=t.sha256=void 0;const n=r(325),s=r(513),i=r(100),o=r(61),a=r(744);t.sha256=function(e){var t;return e.byteLength?(null===(t=r.g.crypto)||void 0===t?void 0:t.subtle)?r.g.crypto.subtle.digest({name:"SHA-256"},e):new Promise((t=>{t(a.createHash("sha256").update(Buffer.from(e)).digest().buffer)})):Promise.resolve((0,i.arrayToBuffer)((0,i.hexToBytes)("e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855")))},t.sha512=function(e){var t;return e.byteLength?(null===(t=r.g.crypto)||void 0===t?void 0:t.subtle)?r.g.crypto.subtle.digest({name:"SHA-512"},e):new Promise((t=>{t(a.createHash("sha512").update(Buffer.from(e)).digest().buffer)})):Promise.resolve((0,i.arrayToBuffer)((0,i.hexToBytes)("cf83e1357eefb8bdf1542850d66d8007d620e4050b5715dc83f4a921d36ce9ce47d0d13c5d85f2b0ff8318d2877eec2f63b931bd47417a81a538327af927da3e")))},t.hmacSha256=function(e,t){var n;if(null===(n=r.g.crypto)||void 0===n?void 0:n.subtle){const n={name:"HMAC",hash:{name:"SHA-256"}};return r.g.crypto.subtle.importKey("raw",e,n,!1,["sign"]).then((e=>r.g.crypto.subtle.sign(n,e,t)))}return new Promise((r=>{r(a.createHmac("sha256",Buffer.from(e)).update(Buffer.from(t)).digest().buffer)}))};class d{}t.AesCbc=d;class h extends d{get key(){if(!this._key)throw new n.KdbxError(s.ErrorCodes.InvalidState,"no key");return this._key}importKey(e){return r.g.crypto.subtle.importKey("raw",e,{name:"AES-CBC"},!1,["encrypt","decrypt"]).then((e=>{this._key=e}))}encrypt(e,t){return r.g.crypto.subtle.encrypt({name:"AES-CBC",iv:t},this.key,e)}decrypt(e,t){return r.g.crypto.subtle.decrypt({name:"AES-CBC",iv:t},this.key,e).catch((()=>{throw new n.KdbxError(s.ErrorCodes.InvalidKey,"invalid key")}))}}class l extends d{get key(){if(!this._key)throw new n.KdbxError(s.ErrorCodes.InvalidState,"no key");return this._key}importKey(e){return this._key=e,Promise.resolve()}encrypt(e,t){return Promise.resolve().then((()=>{const r=a.createCipheriv("aes-256-cbc",Buffer.from(this.key),Buffer.from(t)),n=r.update(Buffer.from(e));return(0,i.arrayToBuffer)(Buffer.concat([n,r.final()]))}))}decrypt(e,t){return Promise.resolve().then((()=>{const r=a.createDecipheriv("aes-256-cbc",Buffer.from(this.key),Buffer.from(t)),n=r.update(Buffer.from(e));return(0,i.arrayToBuffer)(Buffer.concat([n,r.final()]))})).catch((()=>{throw new n.KdbxError(s.ErrorCodes.InvalidKey,"invalid key")}))}}let c;t.createAesCbc=function(){var e;return(null===(e=r.g.crypto)||void 0===e?void 0:e.subtle)?new h:new l},t.random=function(e){var t;return(null===(t=r.g.crypto)||void 0===t?void 0:t.subtle)?function(e){const t=new Uint8Array(e);for(;e>0;){let n=e%65536;n=n>0?n:65536;const s=new Uint8Array(n);r.g.crypto.getRandomValues(s),e-=n,t.set(s,e)}return t}(e):new Uint8Array(a.randomBytes(e))},t.chacha20=function(e,t,r){return Promise.resolve().then((()=>{const n=new o.ChaCha20(new Uint8Array(t),new Uint8Array(r));return(0,i.arrayToBuffer)(n.encrypt(new Uint8Array(e)))}))},t.Argon2TypeArgon2d=0,t.Argon2TypeArgon2id=2,t.argon2=function(e,t,r,o,a,d,h,l){return c?c(e,t,r,o,a,d,h,l).then(i.arrayToBuffer):Promise.reject(new n.KdbxError(s.ErrorCodes.NotImplemented,"argon2 not implemented"))},t.setArgon2Impl=function(e){c=e}},8:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.encrypt=t.decrypt=void 0;const n=r(909),s=r(613),i=r(325),o=r(100),a=r(513);t.decrypt=function(e){return Promise.resolve().then((()=>{const t=new n.BinaryStream(e),r=[];let d,h=0,l=0;const c=()=>{if(t.getUint32(!0),d=t.readBytes(32),h=t.getUint32(!0),h>0){l+=h;const e=t.readBytes(h);return s.sha256(e).then((t=>{if((0,o.arrayBufferEquals)(t,d))return r.push(e),c();throw new i.KdbxError(a.ErrorCodes.FileCorrupt,"invalid hash block")}))}{const e=new Uint8Array(l);let t=0;for(let n=0;n<r.length;n++)e.set(new Uint8Array(r[n]),t),t+=r[n].byteLength;return Promise.resolve(e.buffer)}};return c()}))},t.encrypt=function(e){return Promise.resolve().then((()=>{let t=e.byteLength,r=0,i=0,o=0;const a=[],d=()=>{if(t>0){const h=Math.min(1048576,t);t-=h;const l=e.slice(r,r+h);return s.sha256(l).then((e=>{const t=new ArrayBuffer(40),s=new n.BinaryStream(t);return s.setUint32(i,!0),s.writeBytes(e),s.setUint32(h,!0),a.push(t),o+=t.byteLength,a.push(l),o+=l.byteLength,i++,r+=h,d()}))}{const e=new ArrayBuffer(40);new DataView(e).setUint32(0,i,!0),a.push(e),o+=e.byteLength;const t=new Uint8Array(o);let r=0;for(let e=0;e<a.length;e++)t.set(new Uint8Array(a[e]),r),r+=a[e].byteLength;return Promise.resolve(t.buffer)}};return d()}))}},522:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.encrypt=t.decrypt=t.getHmacKey=void 0;const n=r(880),s=r(100),i=r(613),o=r(909),a=r(325),d=r(513);function h(e,t){const r=new Uint8Array(8+e.byteLength);r.set(new Uint8Array(e),8);const n=new DataView(r.buffer);return n.setUint32(0,t.lo,!0),n.setUint32(4,t.hi,!0),i.sha512((0,s.arrayToBuffer)(r)).then((e=>((0,s.zeroBuffer)(r),e)))}function l(e,t,r,s){return h(e,new n.Int64(t)).then((e=>{const n=new Uint8Array(s.byteLength+4+8),o=new DataView(n.buffer);return n.set(new Uint8Array(s),12),o.setInt32(0,t,!0),o.setInt32(8,r,!0),i.hmacSha256(e,n.buffer)}))}t.getHmacKey=h,t.decrypt=function(e,t){const r=new o.BinaryStream(e);return Promise.resolve().then((()=>{const e=[];let n,i=0,o=0,h=0;const c=()=>{if(n=r.readBytes(32),o=r.getUint32(!0),o>0){h+=o;const u=r.readBytes(o);return l(t,i,o,u).then((t=>{if((0,s.arrayBufferEquals)(t,n))return e.push(u),i++,c();throw new a.KdbxError(d.ErrorCodes.FileCorrupt,"invalid hash block")}))}{const t=new Uint8Array(h);let r=0;for(let n=0;n<e.length;n++)t.set(new Uint8Array(e[n]),r),r+=e[n].byteLength;return Promise.resolve(t.buffer)}};return c()}))},t.encrypt=function(e,t){return Promise.resolve().then((()=>{let r=e.byteLength,n=0,s=0,i=0;const a=[],d=()=>{const h=Math.min(1048576,r);r-=h;const c=e.slice(n,n+h);return l(t,s,h,c).then((e=>{const t=new ArrayBuffer(36),r=new o.BinaryStream(t);if(r.writeBytes(e),r.setUint32(h,!0),a.push(t),i+=t.byteLength,c.byteLength>0)return a.push(c),i+=c.byteLength,s++,n+=h,d();{const e=new Uint8Array(i);let t=0;for(let r=0;r<a.length;r++)e.set(new Uint8Array(a[r]),t),t+=a[r].byteLength;return e.buffer}}))};return d()}))}},695:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.encrypt=void 0;const n=r(613),s=r(100),i=16;function o(e,t,r){let n=Promise.resolve((0,s.arrayToBuffer)(t));const o=new Uint8Array(i*Math.min(r,1e4));for(;r>0;){const t=Math.min(r,1e4);r-=t;const d=i*t;n=a(e,n,o.length===d?o.buffer:(0,s.arrayToBuffer)(o.subarray(0,d)))}return n.then((e=>new Uint8Array(e)))}function a(e,t,r){return t.then((t=>e.encrypt(r,t))).then((e=>{const t=(0,s.arrayToBuffer)(new Uint8Array(e).subarray(-32,-16));return(0,s.zeroBuffer)(e),t}))}t.encrypt=function(e,t,r){const a=n.createAesCbc();return a.importKey((0,s.arrayToBuffer)(t)).then((()=>{const t=[];for(let n=0;n<32;n+=i)t.push(o(a,e.subarray(n,n+i),r));return Promise.all(t)})).then((e=>{const t=new Uint8Array(32);return e.forEach(((e,r)=>{const n=r*i;for(let r=0;r<i;++r)t[r+n]=e[r];(0,s.zeroBuffer)(e)})),t}))}},879:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.encrypt=void 0;const n=r(613),s=r(695),i=r(325),o=r(513),a=r(100),d=r(880);function h(e,t,r){const s=t.get("S");if(!(s instanceof ArrayBuffer)||32!==s.byteLength)return Promise.reject(new i.KdbxError(o.ErrorCodes.FileCorrupt,"bad argon2 salt"));const a=l(t.get("P"));if("number"!=typeof a||a<1)return Promise.reject(new i.KdbxError(o.ErrorCodes.FileCorrupt,"bad argon2 parallelism"));const d=l(t.get("I"));if("number"!=typeof d||d<1)return Promise.reject(new i.KdbxError(o.ErrorCodes.FileCorrupt,"bad argon2 iterations"));const h=l(t.get("M"));if("number"!=typeof h||h<1||h%1024!=0)return Promise.reject(new i.KdbxError(o.ErrorCodes.FileCorrupt,"bad argon2 memory"));const c=t.get("V");if(19!==c&&16!==c)return Promise.reject(new i.KdbxError(o.ErrorCodes.FileCorrupt,"bad argon2 version"));if(t.get("K"))return Promise.reject(new i.KdbxError(o.ErrorCodes.Unsupported,"argon2 secret key"));return t.get("A")?Promise.reject(new i.KdbxError(o.ErrorCodes.Unsupported,"argon2 assoc data")):n.argon2(e,s,h/1024,d,32,a,r,c)}function l(e){return"number"==typeof e?e:e instanceof d.Int64?e.value:void 0}t.encrypt=function(e,t){const r=t.get("$UUID");if(!(r&&r instanceof ArrayBuffer))return Promise.reject(new i.KdbxError(o.ErrorCodes.FileCorrupt,"no kdf uuid"));switch((0,a.bytesToBase64)(r)){case o.KdfId.Argon2d:return h(e,t,n.Argon2TypeArgon2d);case o.KdfId.Argon2id:return h(e,t,n.Argon2TypeArgon2id);case o.KdfId.Aes:return function(e,t){const r=t.get("S");if(!(r instanceof ArrayBuffer)||32!==r.byteLength)return Promise.reject(new i.KdbxError(o.ErrorCodes.FileCorrupt,"bad aes salt"));const d=l(t.get("R"));if("number"!=typeof d||d<1)return Promise.reject(new i.KdbxError(o.ErrorCodes.FileCorrupt,"bad aes rounds"));return s.encrypt(new Uint8Array(e),new Uint8Array(r),d).then((e=>n.sha256(e).then((t=>((0,a.zeroBuffer)(e),t)))))}(e,t);default:return Promise.reject(new i.KdbxError(o.ErrorCodes.Unsupported,"bad kdf"))}}},328:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ProtectSaltGenerator=void 0;const n=r(18),s=r(61),i=r(100),o=r(513),a=r(325),d=r(613),h=new Uint8Array([232,48,9,75,151,32,93,42]);class l{constructor(e){this._algo=e}getSalt(e){return(0,i.arrayToBuffer)(this._algo.getBytes(e))}static create(e,t){switch(t){case o.CrsAlgorithm.Salsa20:return d.sha256((0,i.arrayToBuffer)(e)).then((e=>{const t=new Uint8Array(e),r=new n.Salsa20(t,h);return new l(r)}));case o.CrsAlgorithm.ChaCha20:return d.sha512((0,i.arrayToBuffer)(e)).then((e=>{const t=new Uint8Array(e,0,32),r=new Uint8Array(e,32,12),n=new s.ChaCha20(t,r);return new l(n)}));default:return Promise.reject(new a.KdbxError(o.ErrorCodes.Unsupported,"crsAlgorithm"))}}}t.ProtectSaltGenerator=l},758:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ProtectedValue=void 0;const n=r(613),s=r(100);class i{constructor(e,t){this.value=new Uint8Array(e),this.salt=new Uint8Array(t)}toString(){return(0,s.bytesToBase64)(this.value)}static fromString(e){const t=(0,s.stringToBytes)(e),r=n.random(t.length);for(let e=0,n=t.length;e<n;e++)t[e]^=r[e];return new i((0,s.arrayToBuffer)(t),(0,s.arrayToBuffer)(r))}toBase64(){const e=this.getBinary(),t=(0,s.bytesToBase64)(e);return(0,s.zeroBuffer)(e),t}static fromBase64(e){const t=(0,s.base64ToBytes)(e);return i.fromBinary(t)}static fromBinary(e){const t=new Uint8Array(e),r=n.random(t.length);for(let e=0,n=t.length;e<n;e++)t[e]^=r[e];return new i((0,s.arrayToBuffer)(t),(0,s.arrayToBuffer)(r))}includes(e){if(0===e.length)return!1;const t=this.value,r=this.salt,n=(0,s.stringToBytes)(e),i=t.length,o=n.length,a=i-o;e:for(let e=0;e<=a;e++){for(let s=0;s<o;s++)if((t[e+s]^r[e+s])!==n[s])continue e;return!0}return!1}getHash(){const e=(0,s.arrayToBuffer)(this.getBinary());return n.sha256(e).then((t=>((0,s.zeroBuffer)(e),t)))}getText(){return(0,s.bytesToString)(this.getBinary())}getBinary(){const e=this.value,t=this.salt,r=new Uint8Array(e.byteLength);for(let n=r.length-1;n>=0;n--)r[n]=e[n]^t[n];return r}setSalt(e){const t=new Uint8Array(e),r=this.value,n=this.salt;for(let e=0,s=r.length;e<s;e++)r[e]=r[e]^n[e]^t[e],n[e]=t[e]}clone(){return new i(this.value,this.salt)}get byteLength(){return this.value.byteLength}}t.ProtectedValue=i},18:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Salsa20=void 0;t.Salsa20=class{constructor(e,t){this._rounds=20,this._sigmaWords=[1634760805,857760878,2036477234,1797285236],this._keyWords=[],this._nonceWords=[0,0],this._counterWords=[0,0],this._block=new Uint8Array(64),this._blockUsed=64,this.setKey(e),this.setNonce(t)}setKey(e){for(let t=0,r=0;t<8;t++,r+=4)this._keyWords[t]=255&e[r]|(255&e[r+1])<<8|(255&e[r+2])<<16|(255&e[r+3])<<24;this.reset()}setNonce(e){this._nonceWords[0]=255&e[0]|(255&e[1])<<8|(255&e[2])<<16|(255&e[3])<<24,this._nonceWords[1]=255&e[4]|(255&e[5])<<8|(255&e[6])<<16|(255&e[7])<<24,this.reset()}getBytes(e){const t=new Uint8Array(e);for(let r=0;r<e;r++)64===this._blockUsed&&(this.generateBlock(),this.incrementCounter(),this._blockUsed=0),t[r]=this._block[this._blockUsed],this._blockUsed++;return t}getHexString(e){const t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],r=[],n=this.getBytes(e);for(let e=0;e<n.length;e++)r.push(t[n[e]>>4&15]),r.push(t[15&n[e]]);return r.join("")}reset(){this._counterWords[0]=0,this._counterWords[1]=0,this._blockUsed=64}incrementCounter(){this._counterWords[0]=this._counterWords[0]+1&4294967295,0===this._counterWords[0]&&(this._counterWords[1]=this._counterWords[1]+1&4294967295)}generateBlock(){const e=this._sigmaWords[0],t=this._keyWords[0],r=this._keyWords[1],n=this._keyWords[2],s=this._keyWords[3],i=this._sigmaWords[1],o=this._nonceWords[0],a=this._nonceWords[1],d=this._counterWords[0],h=this._counterWords[1],l=this._sigmaWords[2],c=this._keyWords[4],u=this._keyWords[5],f=this._keyWords[6],m=this._keyWords[7],y=this._sigmaWords[3];let p,g=e,b=t,v=r,C=n,w=s,x=i,E=o,k=a,B=d,T=h,K=l,S=c,I=u,_=f,U=m,A=y;for(let e=0;e<this._rounds;e+=2)p=g+I,w^=p<<7|p>>>25,p=w+g,B^=p<<9|p>>>23,p=B+w,I^=p<<13|p>>>19,p=I+B,g^=p<<18|p>>>14,p=x+b,T^=p<<7|p>>>25,p=T+x,_^=p<<9|p>>>23,p=_+T,b^=p<<13|p>>>19,p=b+_,x^=p<<18|p>>>14,p=K+E,U^=p<<7|p>>>25,p=U+K,v^=p<<9|p>>>23,p=v+U,E^=p<<13|p>>>19,p=E+v,K^=p<<18|p>>>14,p=A+S,C^=p<<7|p>>>25,p=C+A,k^=p<<9|p>>>23,p=k+C,S^=p<<13|p>>>19,p=S+k,A^=p<<18|p>>>14,p=g+C,b^=p<<7|p>>>25,p=b+g,v^=p<<9|p>>>23,p=v+b,C^=p<<13|p>>>19,p=C+v,g^=p<<18|p>>>14,p=x+w,E^=p<<7|p>>>25,p=E+x,k^=p<<9|p>>>23,p=k+E,w^=p<<13|p>>>19,p=w+k,x^=p<<18|p>>>14,p=K+T,S^=p<<7|p>>>25,p=S+K,B^=p<<9|p>>>23,p=B+S,T^=p<<13|p>>>19,p=T+B,K^=p<<18|p>>>14,p=A+U,I^=p<<7|p>>>25,p=I+A,_^=p<<9|p>>>23,p=_+I,U^=p<<13|p>>>19,p=U+_,A^=p<<18|p>>>14;g+=e,b+=t,v+=r,C+=n,w+=s,x+=i,E+=o,k+=a,B+=d,T+=h,K+=l,S+=c,I+=u,_+=f,U+=m,A+=y,this._block[0]=g>>>0&255,this._block[1]=g>>>8&255,this._block[2]=g>>>16&255,this._block[3]=g>>>24&255,this._block[4]=b>>>0&255,this._block[5]=b>>>8&255,this._block[6]=b>>>16&255,this._block[7]=b>>>24&255,this._block[8]=v>>>0&255,this._block[9]=v>>>8&255,this._block[10]=v>>>16&255,this._block[11]=v>>>24&255,this._block[12]=C>>>0&255,this._block[13]=C>>>8&255,this._block[14]=C>>>16&255,this._block[15]=C>>>24&255,this._block[16]=w>>>0&255,this._block[17]=w>>>8&255,this._block[18]=w>>>16&255,this._block[19]=w>>>24&255,this._block[20]=x>>>0&255,this._block[21]=x>>>8&255,this._block[22]=x>>>16&255,this._block[23]=x>>>24&255,this._block[24]=E>>>0&255,this._block[25]=E>>>8&255,this._block[26]=E>>>16&255,this._block[27]=E>>>24&255,this._block[28]=k>>>0&255,this._block[29]=k>>>8&255,this._block[30]=k>>>16&255,this._block[31]=k>>>24&255,this._block[32]=B>>>0&255,this._block[33]=B>>>8&255,this._block[34]=B>>>16&255,this._block[35]=B>>>24&255,this._block[36]=T>>>0&255,this._block[37]=T>>>8&255,this._block[38]=T>>>16&255,this._block[39]=T>>>24&255,this._block[40]=K>>>0&255,this._block[41]=K>>>8&255,this._block[42]=K>>>16&255,this._block[43]=K>>>24&255,this._block[44]=S>>>0&255,this._block[45]=S>>>8&255,this._block[46]=S>>>16&255,this._block[47]=S>>>24&255,this._block[48]=I>>>0&255,this._block[49]=I>>>8&255,this._block[50]=I>>>16&255,this._block[51]=I>>>24&255,this._block[52]=_>>>0&255,this._block[53]=_>>>8&255,this._block[54]=_>>>16&255,this._block[55]=_>>>24&255,this._block[56]=U>>>0&255,this._block[57]=U>>>8&255,this._block[58]=U>>>16&255,this._block[59]=U>>>24&255,this._block[60]=A>>>0&255,this._block[61]=A>>>8&255,this._block[62]=A>>>16&255,this._block[63]=A>>>24&255}}},513:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Icons=t.Defaults=t.AutoTypeObfuscationOptions=t.CipherId=t.KdfId=t.CrsAlgorithm=t.CompressionAlgorithm=t.ErrorCodes=t.Signatures=void 0,t.Signatures={FileMagic:2594363651,Sig2Kdbx:3041655655,Sig2Kdb:3041655653},t.ErrorCodes={NotImplemented:"NotImplemented",InvalidArg:"InvalidArg",BadSignature:"BadSignature",InvalidVersion:"InvalidVersion",Unsupported:"Unsupported",FileCorrupt:"FileCorrupt",InvalidKey:"InvalidKey",MergeError:"MergeError",InvalidState:"InvalidState"},t.CompressionAlgorithm={None:0,GZip:1},t.CrsAlgorithm={Null:0,ArcFourVariant:1,Salsa20:2,ChaCha20:3},t.KdfId={Argon2:"72Nt34wpREuR96mkA+MKDA==",Argon2d:"72Nt34wpREuR96mkA+MKDA==",Argon2id:"nimLGVbbR3OyPfw+xvCh5g==",Aes:"ydnzmmKKRGC/dA0IwYpP6g=="},t.CipherId={Aes:"McHy5r9xQ1C+WAUhavxa/w==",ChaCha20:"1gOKK4tvTLWlJDOaMdu1mg=="},t.AutoTypeObfuscationOptions={None:0,UseClipboard:1},t.Defaults={KeyEncryptionRounds:3e5,MntncHistoryDays:365,HistoryMaxItems:10,HistoryMaxSize:6291456,RecycleBinName:"Recycle Bin"},t.Icons={Key:0,World:1,Warning:2,NetworkServer:3,MarkedDirectory:4,UserCommunication:5,Parts:6,Notepad:7,WorldSocket:8,Identity:9,PaperReady:10,Digicam:11,IRCommunication:12,MultiKeys:13,Energy:14,Scanner:15,WorldStar:16,CDRom:17,Monitor:18,EMail:19,Configuration:20,ClipboardReady:21,PaperNew:22,Screen:23,EnergyCareful:24,EMailBox:25,Disk:26,Drive:27,PaperQ:28,TerminalEncrypted:29,Console:30,Printer:31,ProgramIcons:32,Run:33,Settings:34,WorldComputer:35,Archive:36,Homebanking:37,DriveWindows:39,Clock:39,EMailSearch:40,PaperFlag:41,Memory:42,TrashBin:43,Note:44,Expired:45,Info:46,Package:47,Folder:48,FolderOpen:49,FolderPackage:50,LockOpen:51,PaperLocked:52,Checked:53,Pen:54,Thumbnail:55,Book:56,List:57,UserKey:58,Tool:59,Home:60,Star:61,Tux:62,Feather:63,Apple:64,Wiki:65,Money:66,Certificate:67,BlackBerry:68}},638:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Val=t.Attr=t.Elem=void 0,t.Elem={DocNode:"KeePassFile",Meta:"Meta",Root:"Root",Group:"Group",Entry:"Entry",Generator:"Generator",HeaderHash:"HeaderHash",SettingsChanged:"SettingsChanged",DbName:"DatabaseName",DbNameChanged:"DatabaseNameChanged",DbDesc:"DatabaseDescription",DbDescChanged:"DatabaseDescriptionChanged",DbDefaultUser:"DefaultUserName",DbDefaultUserChanged:"DefaultUserNameChanged",DbMntncHistoryDays:"MaintenanceHistoryDays",DbColor:"Color",DbKeyChanged:"MasterKeyChanged",DbKeyChangeRec:"MasterKeyChangeRec",DbKeyChangeForce:"MasterKeyChangeForce",RecycleBinEnabled:"RecycleBinEnabled",RecycleBinUuid:"RecycleBinUUID",RecycleBinChanged:"RecycleBinChanged",EntryTemplatesGroup:"EntryTemplatesGroup",EntryTemplatesGroupChanged:"EntryTemplatesGroupChanged",HistoryMaxItems:"HistoryMaxItems",HistoryMaxSize:"HistoryMaxSize",LastSelectedGroup:"LastSelectedGroup",LastTopVisibleGroup:"LastTopVisibleGroup",MemoryProt:"MemoryProtection",ProtTitle:"ProtectTitle",ProtUserName:"ProtectUserName",ProtPassword:"ProtectPassword",ProtUrl:"ProtectURL",ProtNotes:"ProtectNotes",CustomIcons:"CustomIcons",CustomIconItem:"Icon",CustomIconItemID:"UUID",CustomIconItemData:"Data",CustomIconItemName:"Name",AutoType:"AutoType",History:"History",Name:"Name",Notes:"Notes",Uuid:"UUID",Icon:"IconID",CustomIconID:"CustomIconUUID",FgColor:"ForegroundColor",BgColor:"BackgroundColor",OverrideUrl:"OverrideURL",Times:"Times",Tags:"Tags",QualityCheck:"QualityCheck",PreviousParentGroup:"PreviousParentGroup",CreationTime:"CreationTime",LastModTime:"LastModificationTime",LastAccessTime:"LastAccessTime",ExpiryTime:"ExpiryTime",Expires:"Expires",UsageCount:"UsageCount",LocationChanged:"LocationChanged",GroupDefaultAutoTypeSeq:"DefaultAutoTypeSequence",EnableAutoType:"EnableAutoType",EnableSearching:"EnableSearching",String:"String",Binary:"Binary",Key:"Key",Value:"Value",AutoTypeEnabled:"Enabled",AutoTypeObfuscation:"DataTransferObfuscation",AutoTypeDefaultSeq:"DefaultSequence",AutoTypeItem:"Association",Window:"Window",KeystrokeSequence:"KeystrokeSequence",Binaries:"Binaries",IsExpanded:"IsExpanded",LastTopVisibleEntry:"LastTopVisibleEntry",DeletedObjects:"DeletedObjects",DeletedObject:"DeletedObject",DeletionTime:"DeletionTime",CustomData:"CustomData",StringDictExItem:"Item"},t.Attr={Id:"ID",Ref:"Ref",Protected:"Protected",ProtectedInMemPlainXml:"ProtectInMemory",Compressed:"Compressed"},t.Val={False:"False",True:"True"}},325:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.KdbxError=void 0;class r extends Error{constructor(e,t){super("Error "+e+(t?": "+t:"")),this.name="KdbxError",this.code=e}}t.KdbxError=r},968:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.KdbxBinaries=void 0;const n=r(613),s=r(758),i=r(100);class o{constructor(){this._mapById=new Map,this._mapByHash=new Map,this._idToHash=new Map}computeHashes(){const e=[...this._mapById].map((([e,t])=>o.getBinaryHash(t).then((r=>{this._idToHash.set(e,r),this._mapByHash.set(r,t)}))));return Promise.all(e).then((()=>{this._mapById.clear()}))}static getBinaryHash(e){let t;return e instanceof s.ProtectedValue?t=e.getHash():(e=(0,i.arrayToBuffer)(e),t=n.sha256(e)),t.then(i.bytesToHex)}add(e){return e instanceof Uint8Array&&(e=(0,i.arrayToBuffer)(e)),o.getBinaryHash(e).then((t=>(this._mapByHash.set(t,e),{hash:t,value:e})))}addWithNextId(e){const t=this._mapById.size.toString();this.addWithId(t,e)}addWithId(e,t){t instanceof Uint8Array&&(t=(0,i.arrayToBuffer)(t)),this._mapById.set(e,t)}addWithHash(e){this._mapByHash.set(e.hash,e.value)}deleteWithHash(e){this._mapByHash.delete(e)}getByRef(e){const t=this._idToHash.get(e.ref);if(!t)return;const r=this._mapByHash.get(t);return r?{hash:t,value:r}:void 0}getRefByHash(e){const t=[...this._mapByHash.keys()].indexOf(e);if(!(t<0))return{ref:t.toString()}}getAll(){return[...this._mapByHash.values()].map(((e,t)=>({ref:t.toString(),value:e})))}getAllWithHashes(){return[...this._mapByHash].map((([e,t])=>({hash:e,value:t})))}getValueByHash(e){return this._mapByHash.get(e)}static isKdbxBinaryRef(e){var t;return!!(null===(t=e)||void 0===t?void 0:t.ref)}static isKdbxBinaryWithHash(e){var t;return!!(null===(t=e)||void 0===t?void 0:t.hash)}}t.KdbxBinaries=o},497:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.KdbxContext=void 0;const n=r(943);t.KdbxContext=class{constructor(e){this.kdbx=e.kdbx,this.exportXml=!!e.exportXml}setXmlDate(e,t){const r=this.kdbx.versionMajor>=4&&!this.exportXml;n.setDate(e,t,r)}}},374:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.KdbxCredentials=void 0;const n=r(943),s=r(613),i=r(758),o=r(325),a=r(513),d=r(100);class h{constructor(e,t,r){this.ready=Promise.all([this.setPassword(e),this.setKeyFile(t),this.setChallengeResponse(r)]).then((()=>this))}setPassword(e){return e?e instanceof i.ProtectedValue?e.getHash().then((e=>{this.passwordHash=i.ProtectedValue.fromBinary(e)})):Promise.reject(new o.KdbxError(a.ErrorCodes.InvalidArg,"password")):(this.passwordHash=void 0,Promise.resolve())}setKeyFile(e){if(e&&!(e instanceof ArrayBuffer)&&!(e instanceof Uint8Array))return Promise.reject(new o.KdbxError(a.ErrorCodes.InvalidArg,"keyFile"));if(e){if(32===e.byteLength)return this.keyFileHash=i.ProtectedValue.fromBinary((0,d.arrayToBuffer)(e)),Promise.resolve();let t,r;try{const s=(0,d.bytesToString)((0,d.arrayToBuffer)(e));if(/^[a-f\d]{64}$/i.exec(s)){const e=(0,d.hexToBytes)(s);return this.keyFileHash=i.ProtectedValue.fromBinary(e),Promise.resolve()}const h=n.parse(s.trim()),l=n.getChildNode(h.documentElement,"Meta");if(!l)return Promise.reject(new o.KdbxError(a.ErrorCodes.InvalidArg,"key file without meta"));const c=n.getChildNode(l,"Version");if(!(null==c?void 0:c.textContent))return Promise.reject(new o.KdbxError(a.ErrorCodes.InvalidArg,"key file without version"));t=+c.textContent.split(".")[0];const u=n.getChildNode(h.documentElement,"Key");if(!u)return Promise.reject(new o.KdbxError(a.ErrorCodes.InvalidArg,"key file without key"));if(r=n.getChildNode(u,"Data"),!(null==r?void 0:r.textContent))return Promise.reject(new o.KdbxError(a.ErrorCodes.InvalidArg,"key file without key data"))}catch(t){return s.sha256(e).then((e=>{this.keyFileHash=i.ProtectedValue.fromBinary(e)}))}switch(t){case 1:this.keyFileHash=i.ProtectedValue.fromBinary((0,d.base64ToBytes)(r.textContent));break;case 2:{const e=(0,d.hexToBytes)(r.textContent.replace(/\s+/g,"")),t=r.getAttribute("Hash");return s.sha256(e).then((r=>{if((0,d.bytesToHex)(new Uint8Array(r).subarray(0,4)).toUpperCase()!==t)throw new o.KdbxError(a.ErrorCodes.FileCorrupt,"key file data hash mismatch");this.keyFileHash=i.ProtectedValue.fromBinary(e)}))}default:return Promise.reject(new o.KdbxError(a.ErrorCodes.FileCorrupt,"bad keyfile version"))}}else this.keyFileHash=void 0;return Promise.resolve()}setChallengeResponse(e){return this._challengeResponse=e,Promise.resolve()}getHash(e){return this.ready.then((()=>this.getChallengeResponse(e).then((e=>{const t=[];this.passwordHash&&t.push(this.passwordHash.getBinary()),this.keyFileHash&&t.push(this.keyFileHash.getBinary()),e&&t.push(new Uint8Array(e));const r=t.reduce(((e,t)=>e+t.byteLength),0),n=new Uint8Array(r);let i=0;for(const e of t)n.set(e,i),(0,d.zeroBuffer)(e),i+=e.length;return s.sha256((0,d.arrayToBuffer)(n)).then((e=>((0,d.zeroBuffer)(n),e)))}))))}getChallengeResponse(e){return Promise.resolve().then((()=>this._challengeResponse&&e?this._challengeResponse(e).then((e=>s.sha256((0,d.arrayToBuffer)(e)).then((t=>((0,d.zeroBuffer)(e),t))))):null))}static createRandomKeyFile(e=1){const t=s.random(32),r=s.random(32);for(let e=0;e<32;e++)t[e]^=r[e],t[e]^=1e3*Math.random()%255;return h.createKeyFileWithHash(t,e)}static createKeyFileWithHash(e,t=1){const r=2===t?"2.0":"1.00";let n;if(2===t){const t="            ";n=s.sha256(e).then((r=>{const n=(0,d.bytesToHex)(new Uint8Array(r).subarray(0,4)).toUpperCase(),s=(0,d.bytesToHex)(e).toUpperCase();let i='        <Data Hash="'+n+'">\n';for(let e=0;e<2;e++){const r=[0,1,2,3].map((t=>s.substr(32*e+8*t,8)));i+=t,i+=r.join(" "),i+="\n"}return i+="        </Data>\n",i}))}else{const t="        <Data>"+(0,d.bytesToBase64)(e)+"</Data>\n";n=Promise.resolve(t)}return n.then((e=>{const t='<?xml version="1.0" encoding="utf-8"?>\n<KeyFile>\n    <Meta>\n        <Version>'+r+"</Version>\n    </Meta>\n    <Key>\n"+e+"    </Key>\n</KeyFile>";return(0,d.stringToBytes)(t)}))}}t.KdbxCredentials=h},596:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.KdbxCustomData=void 0;const n=r(943),s=r(638);t.KdbxCustomData=class{static read(e){const t=new Map;for(let r=0,n=e.childNodes,i=n.length;r<i;r++){const e=n[r];e.tagName===s.Elem.StringDictExItem&&this.readItem(e,t)}return t}static write(e,t,r){if(!r)return;const i=n.addChildNode(e,s.Elem.CustomData);for(const[e,o]of r)if(null==o?void 0:o.value){const r=n.addChildNode(i,s.Elem.StringDictExItem);n.setText(n.addChildNode(r,s.Elem.Key),e),n.setText(n.addChildNode(r,s.Elem.Value),o.value),o.lastModified&&t.kdbx.versionIsAtLeast(4,1)&&n.setDate(n.addChildNode(r,s.Elem.LastModTime),o.lastModified)}}static readItem(e,t){let r,i,o;for(let t=0,a=e.childNodes,d=a.length;t<d;t++){const e=a[t];switch(e.tagName){case s.Elem.Key:r=n.getText(e);break;case s.Elem.Value:i=n.getText(e);break;case s.Elem.LastModTime:o=n.getDate(e)}}if(r&&void 0!==i){const e={value:i};o&&(e.lastModified=o),t.set(r,e)}}}},414:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.KdbxDeletedObject=void 0;const n=r(943),s=r(638);class i{readNode(e){switch(e.tagName){case s.Elem.Uuid:this.uuid=n.getUuid(e);break;case s.Elem.DeletionTime:this.deletionTime=n.getDate(e)}}write(e,t){const r=n.addChildNode(e,s.Elem.DeletedObject);n.setUuid(n.addChildNode(r,s.Elem.Uuid),this.uuid),t.setXmlDate(n.addChildNode(r,s.Elem.DeletionTime),this.deletionTime)}static read(e){const t=new i;for(let r=0,n=e.childNodes,s=n.length;r<s;r++){const e=n[r];e.tagName&&t.readNode(e)}return t}}t.KdbxDeletedObject=i},270:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.KdbxEntry=void 0;const n=r(638),s=r(943),i=r(554),o=r(513),a=r(758),d=r(596),h=r(552),l=r(968);class c{constructor(){this.uuid=new h.KdbxUuid,this.tags=[],this.times=new i.KdbxTimes,this.fields=new Map,this.binaries=new Map,this.autoType={enabled:!0,obfuscation:o.AutoTypeObfuscationOptions.None,items:[]},this.history=[]}get lastModTime(){var e,t;return null!==(t=null===(e=this.times.lastModTime)||void 0===e?void 0:e.getTime())&&void 0!==t?t:0}get locationChanged(){var e,t;return null!==(t=null===(e=this.times.locationChanged)||void 0===e?void 0:e.getTime())&&void 0!==t?t:0}readNode(e,t){var r,a;switch(e.tagName){case n.Elem.Uuid:this.uuid=null!==(r=s.getUuid(e))&&void 0!==r?r:new h.KdbxUuid;break;case n.Elem.Icon:this.icon=s.getNumber(e)||o.Icons.Key;break;case n.Elem.CustomIconID:this.customIcon=s.getUuid(e);break;case n.Elem.FgColor:this.fgColor=s.getText(e);break;case n.Elem.BgColor:this.bgColor=s.getText(e);break;case n.Elem.OverrideUrl:this.overrideUrl=s.getText(e);break;case n.Elem.Tags:this.tags=s.getTags(e);break;case n.Elem.Times:this.times=i.KdbxTimes.read(e);break;case n.Elem.String:this.readField(e);break;case n.Elem.Binary:this.readBinary(e,t);break;case n.Elem.AutoType:this.readAutoType(e);break;case n.Elem.History:this.readHistory(e,t);break;case n.Elem.CustomData:this.readCustomData(e);break;case n.Elem.QualityCheck:this.qualityCheck=null!==(a=s.getBoolean(e))&&void 0!==a?a:void 0;break;case n.Elem.PreviousParentGroup:this.previousParentGroup=s.getUuid(e)}}readField(e){const t=s.getChildNode(e,n.Elem.Key),r=s.getChildNode(e,n.Elem.Value);if(t&&r){const e=s.getText(t),n=s.getProtectedText(r);e&&this.fields.set(e,n||"")}}writeFields(e){for(const[t,r]of this.fields)if(null!=r){const i=s.addChildNode(e,n.Elem.String);s.setText(s.addChildNode(i,n.Elem.Key),t),s.setProtectedText(s.addChildNode(i,n.Elem.Value),r)}}readBinary(e,t){const r=s.getChildNode(e,n.Elem.Key),i=s.getChildNode(e,n.Elem.Value);if(r&&i){const e=s.getText(r),n=s.getProtectedBinary(i);if(e&&n)if(l.KdbxBinaries.isKdbxBinaryRef(n)){const r=t.kdbx.binaries.getByRef(n);r&&this.binaries.set(e,r)}else this.binaries.set(e,n)}}writeBinaries(e,t){for(const[r,i]of this.binaries){let o;if(l.KdbxBinaries.isKdbxBinaryWithHash(i)){const e=t.kdbx.binaries.getRefByHash(i.hash);if(!e)return;o=e}else o=i;const a=s.addChildNode(e,n.Elem.Binary);s.setText(s.addChildNode(a,n.Elem.Key),r),s.setProtectedBinary(s.addChildNode(a,n.Elem.Value),o)}}readAutoType(e){var t;for(let r=0,i=e.childNodes,a=i.length;r<a;r++){const e=i[r];switch(e.tagName){case n.Elem.AutoTypeEnabled:this.autoType.enabled=null===(t=s.getBoolean(e))||void 0===t||t;break;case n.Elem.AutoTypeObfuscation:this.autoType.obfuscation=s.getNumber(e)||o.AutoTypeObfuscationOptions.None;break;case n.Elem.AutoTypeDefaultSeq:this.autoType.defaultSequence=s.getText(e);break;case n.Elem.AutoTypeItem:this.readAutoTypeItem(e)}}}readAutoTypeItem(e){let t="",r="";for(let i=0,o=e.childNodes,a=o.length;i<a;i++){const e=o[i];switch(e.tagName){case n.Elem.Window:t=s.getText(e)||"";break;case n.Elem.KeystrokeSequence:r=s.getText(e)||""}}t&&r&&this.autoType.items.push({window:t,keystrokeSequence:r})}writeAutoType(e){const t=s.addChildNode(e,n.Elem.AutoType);s.setBoolean(s.addChildNode(t,n.Elem.AutoTypeEnabled),this.autoType.enabled),s.setNumber(s.addChildNode(t,n.Elem.AutoTypeObfuscation),this.autoType.obfuscation||o.AutoTypeObfuscationOptions.None),this.autoType.defaultSequence&&s.setText(s.addChildNode(t,n.Elem.AutoTypeDefaultSeq),this.autoType.defaultSequence);for(let e=0;e<this.autoType.items.length;e++){const r=this.autoType.items[e],i=s.addChildNode(t,n.Elem.AutoTypeItem);s.setText(s.addChildNode(i,n.Elem.Window),r.window),s.setText(s.addChildNode(i,n.Elem.KeystrokeSequence),r.keystrokeSequence)}}readHistory(e,t){for(let r=0,s=e.childNodes,i=s.length;r<i;r++){const e=s[r];switch(e.tagName){case n.Elem.Entry:this.history.push(c.read(e,t))}}}writeHistory(e,t){const r=s.addChildNode(e,n.Elem.History);for(const e of this.history)e.write(r,t)}readCustomData(e){this.customData=d.KdbxCustomData.read(e)}writeCustomData(e,t){this.customData&&d.KdbxCustomData.write(e,t,this.customData)}setField(e,t,r=!1){this.fields.set(e,r?a.ProtectedValue.fromString(t):t)}addHistoryTombstone(e,t){this._editState||(this._editState={added:[],deleted:[]}),this._editState[e?"added":"deleted"].push(t.getTime())}write(e,t){const r=s.addChildNode(e,n.Elem.Entry);s.setUuid(s.addChildNode(r,n.Elem.Uuid),this.uuid),s.setNumber(s.addChildNode(r,n.Elem.Icon),this.icon||o.Icons.Key),this.customIcon&&s.setUuid(s.addChildNode(r,n.Elem.CustomIconID),this.customIcon),s.setText(s.addChildNode(r,n.Elem.FgColor),this.fgColor),s.setText(s.addChildNode(r,n.Elem.BgColor),this.bgColor),s.setText(s.addChildNode(r,n.Elem.OverrideUrl),this.overrideUrl),s.setTags(s.addChildNode(r,n.Elem.Tags),this.tags),"boolean"==typeof this.qualityCheck&&t.kdbx.versionIsAtLeast(4,1)&&s.setBoolean(s.addChildNode(r,n.Elem.QualityCheck),this.qualityCheck),void 0!==this.previousParentGroup&&t.kdbx.versionIsAtLeast(4,1)&&s.setUuid(s.addChildNode(r,n.Elem.PreviousParentGroup),this.previousParentGroup),this.times.write(r,t),this.writeFields(r),this.writeBinaries(r,t),this.writeAutoType(r),this.writeCustomData(r,t),e.tagName!==n.Elem.History&&this.writeHistory(r,t)}pushHistory(){const e=new c;e.copyFrom(this),this.history.push(e),e.times.lastModTime&&this.addHistoryTombstone(!0,e.times.lastModTime)}removeHistory(e,t=1){for(let r=e;r<e+t;r++)if(r<this.history.length){const e=this.history[r].times.lastModTime;e&&this.addHistoryTombstone(!1,e)}this.history.splice(e,t)}copyFrom(e){this.uuid=e.uuid,this.icon=e.icon,this.customIcon=e.customIcon,this.fgColor=e.fgColor,this.bgColor=e.bgColor,this.overrideUrl=e.overrideUrl,this.tags=e.tags.slice(),this.times=e.times.clone(),this.fields=new Map;for(const[t,r]of e.fields)r instanceof a.ProtectedValue?this.fields.set(t,r.clone()):this.fields.set(t,r);this.binaries=new Map;for(const[t,r]of e.binaries)r instanceof a.ProtectedValue?this.binaries.set(t,r.clone()):l.KdbxBinaries.isKdbxBinaryWithHash(r)?this.binaries.set(t,{hash:r.hash,value:r.value}):this.binaries.set(t,r);this.autoType=JSON.parse(JSON.stringify(e.autoType))}merge(e){const t=e.remoteEntries.get(this.uuid.id);if(!t)return;const r=t.history.slice();if(this.lastModTime<t.lastModTime)this.pushHistory(),this.copyFrom(t);else if(this.lastModTime>t.lastModTime){if(!this.history.some((e=>e.lastModTime===t.lastModTime))){const e=new c;e.copyFrom(t),r.push(e)}}this.history=this.mergeHistory(r,t.lastModTime)}mergeHistory(e,t){this.history.sort(((e,t)=>e.lastModTime-t.lastModTime)),e.sort(((e,t)=>e.lastModTime-t.lastModTime));let r=0,n=0;const s=[];for(;r<this.history.length||n<e.length;){const i=this.history[r],o=e[n],a=i&&i.lastModTime,d=o&&o.lastModTime;if(a!==d)if(!i||a>d){if(!this._editState||this._editState.deleted.indexOf(d)<0){const e=new c;e.copyFrom(o),s.push(e)}n++}else(this._editState&&this._editState.added.indexOf(a)>=0||a>t)&&s.push(i),r++;else s.push(i),r++,n++}return s}static create(e,t){const r=new c;return r.uuid=h.KdbxUuid.random(),r.icon=o.Icons.Key,r.times=i.KdbxTimes.create(),r.parentGroup=t,r.setField("Title","",e.memoryProtection.title),r.setField("UserName",e.defaultUser||"",e.memoryProtection.userName),r.setField("Password","",e.memoryProtection.password),r.setField("URL","",e.memoryProtection.url),r.setField("Notes","",e.memoryProtection.notes),r.autoType.enabled="boolean"!=typeof t.enableAutoType||t.enableAutoType,r.autoType.obfuscation=o.AutoTypeObfuscationOptions.None,r}static read(e,t,r){const n=new c;for(let r=0,s=e.childNodes,i=s.length;r<i;r++){const e=s[r];e.tagName&&n.readNode(e,t)}if(n.uuid.empty){n.uuid=h.KdbxUuid.random();for(let e=0;e<n.history.length;e++)n.history[e].uuid=n.uuid}return n.parentGroup=r,n}}t.KdbxEntry=c},257:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.KdbxFormat=void 0;const n=r(547),s=r(513),i=r(325),o=r(909),a=r(497),d=r(447),h=r(100),l=r(328),c=r(943),u=r(522),f=r(8),m=r(613),y=r(695),p=r(879),g=r(880);t.KdbxFormat=class{constructor(e){this.preserveXml=!1,this.kdbx=e,this.ctx=new a.KdbxContext({kdbx:e})}load(e){const t=new o.BinaryStream(e);return this.kdbx.credentials.ready.then((()=>{if(this.kdbx.header=d.KdbxHeader.read(t,this.ctx),3===this.kdbx.header.versionMajor)return this.loadV3(t);if(4===this.kdbx.header.versionMajor)return this.loadV4(t);throw new i.KdbxError(s.ErrorCodes.InvalidVersion,`bad version: ${this.kdbx.versionMajor}`)}))}loadV3(e){return this.decryptXmlV3(e).then((t=>(this.kdbx.xml=c.parse(t),this.setProtectedValues().then((()=>this.kdbx.loadFromXml(this.ctx).then((()=>this.checkHeaderHashV3(e).then((()=>(this.cleanXml(),this.kdbx))))))))))}loadV4(e){return this.getHeaderHash(e).then((t=>{const r=e.readBytes(t.byteLength);if(!(0,h.arrayBufferEquals)(r,t))throw new i.KdbxError(s.ErrorCodes.FileCorrupt,"header hash mismatch");return this.computeKeysV4().then((t=>this.getHeaderHmac(e,t.hmacKey).then((r=>{const a=e.readBytes(r.byteLength);if(!(0,h.arrayBufferEquals)(a,r))throw new i.KdbxError(s.ErrorCodes.InvalidKey);return u.decrypt(e.readBytesToEnd(),t.hmacKey).then((r=>((0,h.zeroBuffer)(t.hmacKey),this.decryptData(r,t.cipherKey).then((r=>{(0,h.zeroBuffer)(t.cipherKey),this.kdbx.header.compression===s.CompressionAlgorithm.GZip&&(r=(0,h.arrayToBuffer)((0,n.gunzipSync)(new Uint8Array(r)))),e=new o.BinaryStream((0,h.arrayToBuffer)(r)),this.kdbx.header.readInnerHeader(e,this.ctx),r=e.readBytesToEnd();const i=(0,h.bytesToString)(r);return this.kdbx.xml=c.parse(i),this.setProtectedValues().then((()=>this.kdbx.loadFromXml(this.ctx).then((e=>(this.cleanXml(),e)))))})))))}))))}))}loadXml(e){return this.kdbx.credentials.ready.then((()=>(this.kdbx.header=d.KdbxHeader.create(),this.kdbx.xml=c.parse(e),c.protectPlainValues(this.kdbx.xml.documentElement),this.kdbx.loadFromXml(this.ctx).then((()=>(this.cleanXml(),this.kdbx))))))}save(){return this.kdbx.credentials.ready.then((()=>{const e=new o.BinaryStream;if(this.kdbx.header.generateSalts(),this.kdbx.header.write(e),3===this.kdbx.versionMajor)return this.saveV3(e);if(4===this.kdbx.versionMajor)return this.saveV4(e);throw new i.KdbxError(s.ErrorCodes.InvalidVersion,`bad version: ${this.kdbx.versionMajor}`)}))}saveV3(e){return this.getHeaderHash(e).then((t=>(this.kdbx.meta.headerHash=t,this.kdbx.buildXml(this.ctx),this.getProtectSaltGenerator().then((t=>{if(!this.kdbx.xml)throw new i.KdbxError(s.ErrorCodes.InvalidState,"no xml");return c.updateProtectedValuesSalt(this.kdbx.xml.documentElement,t),this.encryptXmlV3().then((t=>(this.cleanXml(),e.writeBytes(t),e.getWrittenBytes())))})))))}saveV4(e){return this.kdbx.buildXml(this.ctx),this.getHeaderHash(e).then((t=>(e.writeBytes(t),this.computeKeysV4().then((t=>this.getHeaderHmac(e,t.hmacKey).then((r=>(e.writeBytes(r),this.getProtectSaltGenerator().then((r=>{if(!this.kdbx.xml)throw new i.KdbxError(s.ErrorCodes.InvalidState,"no xml");c.updateProtectedValuesSalt(this.kdbx.xml.documentElement,r);const a=c.serialize(this.kdbx.xml),d=new o.BinaryStream;this.kdbx.header.writeInnerHeader(d,this.ctx);const l=d.getWrittenBytes(),f=(0,h.arrayToBuffer)((0,h.stringToBytes)(a));let m=new ArrayBuffer(l.byteLength+f.byteLength);const y=new Uint8Array(m);return y.set(new Uint8Array(l)),y.set(new Uint8Array(f),l.byteLength),(0,h.zeroBuffer)(f),(0,h.zeroBuffer)(l),this.kdbx.header.compression===s.CompressionAlgorithm.GZip&&(m=(0,h.arrayToBuffer)((0,n.gzipSync)(new Uint8Array(m)))),this.encryptData((0,h.arrayToBuffer)(m),t.cipherKey).then((r=>((0,h.zeroBuffer)(t.cipherKey),u.encrypt(r,t.hmacKey).then((r=>(this.cleanXml(),(0,h.zeroBuffer)(t.hmacKey),e.writeBytes(r),e.getWrittenBytes()))))))}))))))))))}saveXml(e=!1){return this.kdbx.credentials.ready.then((()=>{if(this.kdbx.header.generateSalts(),this.ctx.exportXml=!0,this.kdbx.buildXml(this.ctx),!this.kdbx.xml)throw new i.KdbxError(s.ErrorCodes.InvalidState,"no xml");c.unprotectValues(this.kdbx.xml.documentElement);const t=c.serialize(this.kdbx.xml,e);return c.protectUnprotectedValues(this.kdbx.xml.documentElement),this.cleanXml(),t}))}decryptXmlV3(e){const t=e.readBytesToEnd();return this.getMasterKeyV3().then((e=>this.decryptData(t,e).then((t=>((0,h.zeroBuffer)(e),t=this.trimStartBytesV3(t),f.decrypt(t).then((e=>(this.kdbx.header.compression===s.CompressionAlgorithm.GZip&&(e=(0,h.arrayToBuffer)((0,n.gunzipSync)(new Uint8Array(e)))),(0,h.bytesToString)(e)))))))))}encryptXmlV3(){if(!this.kdbx.xml)throw new i.KdbxError(s.ErrorCodes.InvalidState,"no xml");const e=c.serialize(this.kdbx.xml);let t=(0,h.arrayToBuffer)((0,h.stringToBytes)(e));return this.kdbx.header.compression===s.CompressionAlgorithm.GZip&&(t=(0,h.arrayToBuffer)((0,n.gzipSync)(new Uint8Array(t)))),f.encrypt((0,h.arrayToBuffer)(t)).then((e=>{if(!this.kdbx.header.streamStartBytes)throw new i.KdbxError(s.ErrorCodes.InvalidState,"no header start bytes");const t=new Uint8Array(this.kdbx.header.streamStartBytes),r=new Uint8Array(e.byteLength+t.length);return r.set(t),r.set(new Uint8Array(e),t.length),e=r,this.getMasterKeyV3().then((t=>this.encryptData((0,h.arrayToBuffer)(e),t).then((e=>((0,h.zeroBuffer)(t),e)))))}))}getMasterKeyV3(){return this.kdbx.credentials.getHash().then((e=>{if(!this.kdbx.header.transformSeed||!this.kdbx.header.keyEncryptionRounds||!this.kdbx.header.masterSeed)throw new i.KdbxError(s.ErrorCodes.FileCorrupt,"no header transform parameters");const t=this.kdbx.header.transformSeed,r=this.kdbx.header.keyEncryptionRounds,n=this.kdbx.header.masterSeed;return this.kdbx.credentials.getChallengeResponse(n).then((s=>y.encrypt(new Uint8Array(e),t,r).then((t=>((0,h.zeroBuffer)(e),m.sha256(t).then((e=>{(0,h.zeroBuffer)(t);const r=s?s.byteLength:0,i=new Uint8Array(n.byteLength+e.byteLength+r);return i.set(new Uint8Array(n),0),s&&i.set(new Uint8Array(s),n.byteLength),i.set(new Uint8Array(e),n.byteLength+r),(0,h.zeroBuffer)(e),(0,h.zeroBuffer)(n),s&&(0,h.zeroBuffer)(s),m.sha256(i.buffer).then((e=>((0,h.zeroBuffer)(i.buffer),e)))})))))))}))}trimStartBytesV3(e){if(!this.kdbx.header.streamStartBytes)throw new i.KdbxError(s.ErrorCodes.FileCorrupt,"no stream start bytes");const t=this.kdbx.header.streamStartBytes;if(e.byteLength<t.byteLength)throw new i.KdbxError(s.ErrorCodes.FileCorrupt,"short start bytes");if(!(0,h.arrayBufferEquals)(e.slice(0,this.kdbx.header.streamStartBytes.byteLength),t))throw new i.KdbxError(s.ErrorCodes.InvalidKey);return e.slice(t.byteLength)}setProtectedValues(){return this.getProtectSaltGenerator().then((e=>{if(!this.kdbx.xml)throw new i.KdbxError(s.ErrorCodes.InvalidState,"no xml");c.setProtectedValues(this.kdbx.xml.documentElement,e)}))}getProtectSaltGenerator(){if(!this.kdbx.header.protectedStreamKey||!this.kdbx.header.crsAlgorithm)throw new i.KdbxError(s.ErrorCodes.InvalidState,"bad header parameters");return l.ProtectSaltGenerator.create(this.kdbx.header.protectedStreamKey,this.kdbx.header.crsAlgorithm)}getHeaderHash(e){if(!this.kdbx.header.endPos)throw new i.KdbxError(s.ErrorCodes.InvalidState,"no end pos");const t=e.readBytesNoAdvance(0,this.kdbx.header.endPos);return m.sha256(t)}getHeaderHmac(e,t){if(!this.kdbx.header.endPos)throw new i.KdbxError(s.ErrorCodes.InvalidState,"no end pos");const r=e.readBytesNoAdvance(0,this.kdbx.header.endPos);return u.getHmacKey(t,new g.Int64(4294967295,4294967295)).then((e=>m.hmacSha256(e,r)))}checkHeaderHashV3(e){if(this.kdbx.meta.headerHash){const t=this.kdbx.meta.headerHash;return this.getHeaderHash(e).then((e=>{if(!(0,h.arrayBufferEquals)(t,e))throw new i.KdbxError(s.ErrorCodes.FileCorrupt,"header hash mismatch")}))}return Promise.resolve()}computeKeysV4(){const e=this.kdbx.header.masterSeed;if(!e||32!==e.byteLength)return Promise.reject(new i.KdbxError(s.ErrorCodes.FileCorrupt,"bad master seed"));const t=this.kdbx.header.kdfParameters;if(!t)throw new i.KdbxError(s.ErrorCodes.FileCorrupt,"no kdf params");const r=t.get("S");if(!(r instanceof ArrayBuffer))throw new i.KdbxError(s.ErrorCodes.FileCorrupt,"no salt");return this.kdbx.credentials.getHash(r).then((r=>p.encrypt(r,t).then((t=>{if((0,h.zeroBuffer)(r),!t||32!==t.byteLength)return Promise.reject(new i.KdbxError(s.ErrorCodes.Unsupported,"bad derived key"));const n=new Uint8Array(65);return n.set(new Uint8Array(e),0),n.set(new Uint8Array(t),e.byteLength),n[64]=1,(0,h.zeroBuffer)(t),(0,h.zeroBuffer)(e),Promise.all([m.sha256(n.buffer.slice(0,64)),m.sha512(n.buffer)]).then((e=>((0,h.zeroBuffer)(n),{cipherKey:e[0],hmacKey:e[1]})))}))))}decryptData(e,t){const r=this.kdbx.header.dataCipherUuid;if(!r)throw new i.KdbxError(s.ErrorCodes.FileCorrupt,"no cipher id");switch(r.toString()){case s.CipherId.Aes:return this.transformDataV4Aes(e,t,!1);case s.CipherId.ChaCha20:return this.transformDataV4ChaCha20(e,t);default:return Promise.reject(new i.KdbxError(s.ErrorCodes.Unsupported,"unsupported cipher"))}}encryptData(e,t){const r=this.kdbx.header.dataCipherUuid;if(!r)throw new i.KdbxError(s.ErrorCodes.FileCorrupt,"no cipher id");switch(r.toString()){case s.CipherId.Aes:return this.transformDataV4Aes(e,t,!0);case s.CipherId.ChaCha20:return this.transformDataV4ChaCha20(e,t);default:return Promise.reject(new i.KdbxError(s.ErrorCodes.Unsupported,"unsupported cipher"))}}transformDataV4Aes(e,t,r){const n=m.createAesCbc(),o=this.kdbx.header.encryptionIV;if(!o)throw new i.KdbxError(s.ErrorCodes.FileCorrupt,"no encryption IV");return n.importKey(t).then((()=>r?n.encrypt(e,o):n.decrypt(e,o)))}transformDataV4ChaCha20(e,t){const r=this.kdbx.header.encryptionIV;if(!r)throw new i.KdbxError(s.ErrorCodes.FileCorrupt,"no encryption IV");return m.chacha20(e,t,r)}cleanXml(){this.preserveXml||(this.kdbx.xml=void 0)}}},171:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.KdbxGroup=void 0;const n=r(638),s=r(943),i=r(554),o=r(552),a=r(270),d=r(596),h=r(513);class l{constructor(){this.uuid=new o.KdbxUuid,this.tags=[],this.times=new i.KdbxTimes,this.groups=[],this.entries=[]}get lastModTime(){var e,t;return null!==(t=null===(e=this.times.lastModTime)||void 0===e?void 0:e.getTime())&&void 0!==t?t:0}get locationChanged(){var e,t;return null!==(t=null===(e=this.times.locationChanged)||void 0===e?void 0:e.getTime())&&void 0!==t?t:0}readNode(e,t){var r,h;switch(e.tagName){case n.Elem.Uuid:this.uuid=null!==(r=s.getUuid(e))&&void 0!==r?r:new o.KdbxUuid;break;case n.Elem.Name:this.name=s.getText(e);break;case n.Elem.Notes:this.notes=s.getText(e);break;case n.Elem.Icon:this.icon=s.getNumber(e);break;case n.Elem.CustomIconID:this.customIcon=s.getUuid(e);break;case n.Elem.Tags:this.tags=s.getTags(e);break;case n.Elem.Times:this.times=i.KdbxTimes.read(e);break;case n.Elem.IsExpanded:this.expanded=null!==(h=s.getBoolean(e))&&void 0!==h?h:void 0;break;case n.Elem.GroupDefaultAutoTypeSeq:this.defaultAutoTypeSeq=s.getText(e);break;case n.Elem.EnableAutoType:this.enableAutoType=s.getBoolean(e);break;case n.Elem.EnableSearching:this.enableSearching=s.getBoolean(e);break;case n.Elem.LastTopVisibleEntry:this.lastTopVisibleEntry=s.getUuid(e);break;case n.Elem.Group:this.groups.push(l.read(e,t,this));break;case n.Elem.Entry:this.entries.push(a.KdbxEntry.read(e,t,this));break;case n.Elem.CustomData:this.customData=d.KdbxCustomData.read(e);break;case n.Elem.PreviousParentGroup:this.previousParentGroup=s.getUuid(e)}}write(e,t){const r=s.addChildNode(e,n.Elem.Group);s.setUuid(s.addChildNode(r,n.Elem.Uuid),this.uuid),s.setText(s.addChildNode(r,n.Elem.Name),this.name),s.setText(s.addChildNode(r,n.Elem.Notes),this.notes),s.setNumber(s.addChildNode(r,n.Elem.Icon),this.icon),this.tags.length&&t.kdbx.versionIsAtLeast(4,1)&&s.setTags(s.addChildNode(r,n.Elem.Tags),this.tags),this.customIcon&&s.setUuid(s.addChildNode(r,n.Elem.CustomIconID),this.customIcon),void 0!==this.previousParentGroup&&t.kdbx.versionIsAtLeast(4,1)&&s.setUuid(s.addChildNode(r,n.Elem.PreviousParentGroup),this.previousParentGroup),this.customData&&d.KdbxCustomData.write(r,t,this.customData),this.times.write(r,t),s.setBoolean(s.addChildNode(r,n.Elem.IsExpanded),this.expanded),s.setText(s.addChildNode(r,n.Elem.GroupDefaultAutoTypeSeq),this.defaultAutoTypeSeq),s.setBoolean(s.addChildNode(r,n.Elem.EnableAutoType),this.enableAutoType),s.setBoolean(s.addChildNode(r,n.Elem.EnableSearching),this.enableSearching),s.setUuid(s.addChildNode(r,n.Elem.LastTopVisibleEntry),this.lastTopVisibleEntry);for(const e of this.groups)e.write(r,t);for(const e of this.entries)e.write(r,t)}*allGroups(){yield this;for(const e of this.groups)for(const t of e.allGroups())yield t}*allEntries(){for(const e of this.allGroups())for(const t of e.entries)yield t}*allGroupsAndEntries(){yield this;for(const e of this.entries)yield e;for(const e of this.groups)for(const t of e.allGroupsAndEntries())yield t}merge(e){const t=e.remoteGroups.get(this.uuid.id);if(t){t.lastModTime>this.lastModTime&&this.copyFrom(t),this.groups=this.mergeCollection(this.groups,t.groups,e.groups,e.remoteGroups,e.deleted),this.entries=this.mergeCollection(this.entries,t.entries,e.entries,e.remoteEntries,e.deleted);for(const t of this.groups)t.merge(e);for(const t of this.entries)t.merge(e)}}mergeCollection(e,t,r,n,s){const i=[];for(const t of e){if(!t.uuid||s.has(t.uuid.id))continue;const e=n.get(t.uuid.id);e?e.locationChanged<=t.locationChanged&&i.push(t):i.push(t)}let o=-1;for(const e of t){if(o++,!e.uuid||s.has(e.uuid.id))continue;const n=r.get(e.uuid.id);if(n&&e.locationChanged>n.locationChanged)n.parentGroup=this,i.splice(l.findInsertIx(i,t,o),0,n);else if(!n){let r;if(e instanceof l){const t=new l;t.copyFrom(e),r=t}else{if(!(e instanceof a.KdbxEntry))continue;{const t=new a.KdbxEntry;t.copyFrom(e),r=t}}r.parentGroup=this,i.splice(l.findInsertIx(i,t,o),0,r)}}return i}static findInsertIx(e,t,r){let n=e.length,s=-1;for(let i=0;i<=e.length;i++){let o=0;const a=r>0?t[r-1].uuid.id:void 0,d=r+1<t.length?t[r+1].uuid.id:void 0,h=i>0?e[i-1].uuid.id:void 0,l=i<e.length?e[i].uuid.id:void 0;a||h?a===h&&(o+=5):o+=1,d||l?d===l&&(o+=5):o+=2,o>s&&(n=i,s=o)}return n}copyFrom(e){this.uuid=e.uuid,this.name=e.name,this.notes=e.notes,this.icon=e.icon,this.customIcon=e.customIcon,this.times=e.times.clone(),this.expanded=e.expanded,this.defaultAutoTypeSeq=e.defaultAutoTypeSeq,this.enableAutoType=e.enableAutoType,this.enableSearching=e.enableSearching,this.lastTopVisibleEntry=e.lastTopVisibleEntry}static create(e,t){const r=new l;return r.uuid=o.KdbxUuid.random(),r.icon=h.Icons.Folder,r.times=i.KdbxTimes.create(),r.name=e,r.parentGroup=t,r.expanded=!0,r.enableAutoType=null,r.enableSearching=null,r.lastTopVisibleEntry=new o.KdbxUuid,r}static read(e,t,r){const n=new l;for(let r=0,s=e.childNodes,i=s.length;r<i;r++){const e=s[r];e.tagName&&n.readNode(e,t)}return n.uuid.empty&&(n.uuid=o.KdbxUuid.random()),n.parentGroup=r,n}}t.KdbxGroup=l},447:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.KdbxHeader=void 0;const n=r(513),s=r(552),i=r(336),o=r(909),a=r(325),d=r(100),h=r(613),l=r(880),c=r(758),u=[{name:"EndOfHeader"},{name:"Comment"},{name:"CipherID"},{name:"CompressionFlags"},{name:"MasterSeed"},{name:"TransformSeed",ver:[3]},{name:"TransformRounds",ver:[3]},{name:"EncryptionIV"},{name:"ProtectedStreamKey",ver:[3]},{name:"StreamStartBytes",ver:[3]},{name:"InnerRandomStreamID",ver:[3]},{name:"KdfParameters",ver:[4]},{name:"PublicCustomData",ver:[4]}],f=[{name:"EndOfHeader"},{name:"InnerRandomStreamID"},{name:"InnerRandomStreamKey"},{name:"Binary",skipHeader:!0}],m={DefaultFileVersionMajor:4,MinSupportedVersion:3,MaxSupportedVersion:4,FlagBinaryProtected:1,InnerHeaderBinaryFieldId:3,DefaultKdfAlgo:n.KdfId.Argon2d,DefaultKdfSaltLength:32,DefaultKdfParallelism:1,DefaultKdfIterations:2,DefaultKdfMemory:1048576,DefaultKdfVersion:19,EndOfHeader:13675786},y={3:1,4:0},p={3:1,4:1};class g{constructor(){this.versionMajor=0,this.versionMinor=0}readSignature(e){if(e.byteLength<8)throw new a.KdbxError(n.ErrorCodes.FileCorrupt,"not enough data");const t=e.getUint32(!0),r=e.getUint32(!0);if(t!==n.Signatures.FileMagic||r!==n.Signatures.Sig2Kdbx)throw new a.KdbxError(n.ErrorCodes.BadSignature)}writeSignature(e){e.setUint32(n.Signatures.FileMagic,!0),e.setUint32(n.Signatures.Sig2Kdbx,!0)}readVersion(e){const t=e.getUint16(!0),r=e.getUint16(!0);if(r>m.MaxSupportedVersion||r<m.MinSupportedVersion)throw new a.KdbxError(n.ErrorCodes.InvalidVersion);if(t>p[r])throw new a.KdbxError(n.ErrorCodes.InvalidVersion);this.versionMinor=t,this.versionMajor=r}writeVersion(e){if(!this.versionMajor)throw new a.KdbxError(n.ErrorCodes.InvalidState,"version is not set");e.setUint16(this.versionMinor,!0),e.setUint16(this.versionMajor,!0)}readCipherID(e){if(16!==e.byteLength)throw new a.KdbxError(n.ErrorCodes.Unsupported,"cipher");this.dataCipherUuid=new s.KdbxUuid(e)}writeCipherID(e){if(!this.dataCipherUuid)throw new a.KdbxError(n.ErrorCodes.InvalidState,"cipher id is not set");this.writeFieldSize(e,16),e.writeBytes(this.dataCipherUuid.bytes)}readCompressionFlags(e){const t=new DataView(e).getUint32(0,!0);if(t<0||t>=Object.keys(n.CompressionAlgorithm).length)throw new a.KdbxError(n.ErrorCodes.Unsupported,"compression");this.compression=t}writeCompressionFlags(e){if("number"!=typeof this.compression)throw new a.KdbxError(n.ErrorCodes.InvalidState,"compression is not set");this.writeFieldSize(e,4),e.setUint32(this.compression,!0)}readMasterSeed(e){this.masterSeed=e}writeMasterSeed(e){if(!this.masterSeed)throw new a.KdbxError(n.ErrorCodes.InvalidState,"master seed is not set");this.writeFieldBytes(e,this.masterSeed)}readTransformSeed(e){this.transformSeed=e}writeTransformSeed(e){if(!this.transformSeed)throw new a.KdbxError(n.ErrorCodes.InvalidState,"transform seed is not set");this.writeFieldBytes(e,this.transformSeed)}readTransformRounds(e){this.keyEncryptionRounds=new o.BinaryStream(e).getUint64(!0)}writeTransformRounds(e){if(!this.keyEncryptionRounds)throw new a.KdbxError(n.ErrorCodes.InvalidState,"key encryption rounds is not set");this.writeFieldSize(e,8),e.setUint64(this.keyEncryptionRounds,!0)}readEncryptionIV(e){this.encryptionIV=e}writeEncryptionIV(e){if(!this.encryptionIV)throw new a.KdbxError(n.ErrorCodes.InvalidState,"encryption IV is not set");this.writeFieldBytes(e,this.encryptionIV)}readProtectedStreamKey(e){this.protectedStreamKey=e}writeProtectedStreamKey(e){if(!this.protectedStreamKey)throw new a.KdbxError(n.ErrorCodes.InvalidState,"protected stream key is not set");this.writeFieldBytes(e,this.protectedStreamKey)}readStreamStartBytes(e){this.streamStartBytes=e}writeStreamStartBytes(e){if(!this.streamStartBytes)throw new a.KdbxError(n.ErrorCodes.InvalidState,"stream start bytes is not set");this.writeFieldBytes(e,this.streamStartBytes)}readInnerRandomStreamID(e){this.crsAlgorithm=new DataView(e).getUint32(0,!0)}writeInnerRandomStreamID(e){if(!this.crsAlgorithm)throw new a.KdbxError(n.ErrorCodes.InvalidState,"CRSAlgorithm is not set");this.writeFieldSize(e,4),e.setUint32(this.crsAlgorithm,!0)}readInnerRandomStreamKey(e){this.protectedStreamKey=e}writeInnerRandomStreamKey(e){if(!this.protectedStreamKey)throw new a.KdbxError(n.ErrorCodes.InvalidState,"protected stream key is not set");this.writeFieldBytes(e,this.protectedStreamKey)}readKdfParameters(e){this.kdfParameters=i.VarDictionary.read(new o.BinaryStream(e))}writeKdfParameters(e){if(!this.kdfParameters)throw new a.KdbxError(n.ErrorCodes.InvalidState,"KDF parameters are not set");const t=new o.BinaryStream;this.kdfParameters.write(t),this.writeFieldBytes(e,t.getWrittenBytes())}readPublicCustomData(e){this.publicCustomData=i.VarDictionary.read(new o.BinaryStream(e))}hasPublicCustomData(){return!!this.publicCustomData}writePublicCustomData(e){if(this.publicCustomData){const t=new o.BinaryStream;this.publicCustomData.write(t),this.writeFieldBytes(e,t.getWrittenBytes())}}readBinary(e,t){const r=new DataView(e).getUint8(0)&m.FlagBinaryProtected,n=e.slice(1),s=r?c.ProtectedValue.fromBinary(n):n;t.kdbx.binaries.addWithNextId(s)}writeBinary(e,t){if(this.versionMajor<4)return;const r=t.kdbx.binaries.getAll();for(const t of r)if(e.setUint8(m.InnerHeaderBinaryFieldId),t.value instanceof c.ProtectedValue){const r=t.value.getBinary();this.writeFieldSize(e,r.byteLength+1),e.setUint8(m.FlagBinaryProtected),e.writeBytes(r),(0,d.zeroBuffer)(r)}else this.writeFieldSize(e,t.value.byteLength+1),e.setUint8(0),e.writeBytes(t.value)}writeEndOfHeader(e){this.writeFieldSize(e,4),e.setUint32(m.EndOfHeader,!1)}readField(e,t,r){const s=e.getUint8(),i=this.readFieldSize(e),o=i>0?e.readBytes(i):new ArrayBuffer(0),d=t[s];switch(d.name){case"EndOfHeader":case"Comment":break;case"CipherID":this.readCipherID(o);break;case"CompressionFlags":this.readCompressionFlags(o);break;case"MasterSeed":this.readMasterSeed(o);break;case"TransformSeed":this.readTransformSeed(o);break;case"TransformRounds":this.readTransformRounds(o);break;case"EncryptionIV":this.readEncryptionIV(o);break;case"ProtectedStreamKey":this.readProtectedStreamKey(o);break;case"StreamStartBytes":this.readStreamStartBytes(o);break;case"InnerRandomStreamID":this.readInnerRandomStreamID(o);break;case"KdfParameters":this.readKdfParameters(o);break;case"PublicCustomData":this.readPublicCustomData(o);break;case"InnerRandomStreamKey":this.readInnerRandomStreamKey(o);break;case"Binary":this.readBinary(o,r);break;default:throw new a.KdbxError(n.ErrorCodes.InvalidArg,`bad header field: ${d.name}`)}return 0!==s}writeField(e,t,r,s){const i=r[t];if(i){if(i.ver&&!i.ver.includes(this.versionMajor))return;switch(i.name){case"PublicCustomData":if(!this.hasPublicCustomData())return;break;case"Comment":return}switch(i.skipHeader||e.setUint8(t),i.name){case"EndOfHeader":this.writeEndOfHeader(e);break;case"CipherID":this.writeCipherID(e);break;case"CompressionFlags":this.writeCompressionFlags(e);break;case"MasterSeed":this.writeMasterSeed(e);break;case"TransformSeed":this.writeTransformSeed(e);break;case"TransformRounds":this.writeTransformRounds(e);break;case"EncryptionIV":this.writeEncryptionIV(e);break;case"ProtectedStreamKey":this.writeProtectedStreamKey(e);break;case"StreamStartBytes":this.writeStreamStartBytes(e);break;case"InnerRandomStreamID":this.writeInnerRandomStreamID(e);break;case"KdfParameters":this.writeKdfParameters(e);break;case"PublicCustomData":this.writePublicCustomData(e);break;case"InnerRandomStreamKey":this.writeInnerRandomStreamKey(e);break;case"Binary":if(!s)throw new a.KdbxError(n.ErrorCodes.InvalidArg,"context is not set");this.writeBinary(e,s);break;default:throw new a.KdbxError(n.ErrorCodes.InvalidArg,`Bad header field: ${i.name}`)}}}readFieldSize(e){return(0|this.versionMajor)>=4?e.getUint32(!0):e.getUint16(!0)}writeFieldSize(e,t){(0|this.versionMajor)>=4?e.setUint32(t,!0):e.setUint16(t,!0)}writeFieldBytes(e,t){this.writeFieldSize(e,t.byteLength),e.writeBytes(t)}validate(){if(!this.versionMajor||void 0===this.versionMinor)throw new a.KdbxError(n.ErrorCodes.FileCorrupt,"no version in header");if(void 0===this.dataCipherUuid)throw new a.KdbxError(n.ErrorCodes.FileCorrupt,"no cipher in header");if(void 0===this.compression)throw new a.KdbxError(n.ErrorCodes.FileCorrupt,"no compression in header");if(!this.masterSeed)throw new a.KdbxError(n.ErrorCodes.FileCorrupt,"no master seed in header");if(this.versionMajor<4&&!this.transformSeed)throw new a.KdbxError(n.ErrorCodes.FileCorrupt,"no transform seed in header");if(this.versionMajor<4&&!this.keyEncryptionRounds)throw new a.KdbxError(n.ErrorCodes.FileCorrupt,"no key encryption rounds in header");if(!this.encryptionIV)throw new a.KdbxError(n.ErrorCodes.FileCorrupt,"no encryption iv in header");if(this.versionMajor<4&&!this.protectedStreamKey)throw new a.KdbxError(n.ErrorCodes.FileCorrupt,"no protected stream key in header");if(this.versionMajor<4&&!this.streamStartBytes)throw new a.KdbxError(n.ErrorCodes.FileCorrupt,"no stream start bytes in header");if(this.versionMajor<4&&!this.crsAlgorithm)throw new a.KdbxError(n.ErrorCodes.FileCorrupt,"no crs algorithm in header");if(this.versionMajor>=4&&!this.kdfParameters)throw new a.KdbxError(n.ErrorCodes.FileCorrupt,"no kdf parameters in header")}validateInner(){if(!this.protectedStreamKey)throw new a.KdbxError(n.ErrorCodes.FileCorrupt,"no protected stream key in header");if(!this.crsAlgorithm)throw new a.KdbxError(n.ErrorCodes.FileCorrupt,"no crs algorithm in header")}createKdfParameters(e){switch(e||(e=m.DefaultKdfAlgo),e){case n.KdfId.Argon2d:case n.KdfId.Argon2id:this.kdfParameters=new i.VarDictionary,this.kdfParameters.set("$UUID",i.ValueType.Bytes,(0,d.base64ToBytes)(e)),this.kdfParameters.set("S",i.ValueType.Bytes,h.random(m.DefaultKdfSaltLength)),this.kdfParameters.set("P",i.ValueType.UInt32,m.DefaultKdfParallelism),this.kdfParameters.set("I",i.ValueType.UInt64,new l.Int64(m.DefaultKdfIterations)),this.kdfParameters.set("M",i.ValueType.UInt64,new l.Int64(m.DefaultKdfMemory)),this.kdfParameters.set("V",i.ValueType.UInt32,m.DefaultKdfVersion);break;case n.KdfId.Aes:this.kdfParameters=new i.VarDictionary,this.kdfParameters.set("$UUID",i.ValueType.Bytes,(0,d.base64ToBytes)(n.KdfId.Aes)),this.kdfParameters.set("S",i.ValueType.Bytes,h.random(m.DefaultKdfSaltLength)),this.kdfParameters.set("R",i.ValueType.UInt64,new l.Int64(n.Defaults.KeyEncryptionRounds));break;default:throw new a.KdbxError(n.ErrorCodes.InvalidArg,"bad KDF algo")}}write(e){this.validate(),this.writeSignature(e),this.writeVersion(e);for(let t=1;t<u.length;t++)this.writeField(e,t,u);this.writeField(e,0,u),this.endPos=e.pos}writeInnerHeader(e,t){this.validateInner();for(let r=1;r<f.length;r++)this.writeField(e,r,f,t);this.writeField(e,0,f,t)}generateSalts(){if(this.masterSeed=h.random(32),this.versionMajor<4)this.transformSeed=h.random(32),this.streamStartBytes=h.random(32),this.protectedStreamKey=h.random(32),this.encryptionIV=h.random(16);else{if(this.protectedStreamKey=h.random(64),!this.kdfParameters||!this.dataCipherUuid)throw new a.KdbxError(n.ErrorCodes.InvalidState,"no kdf params");this.kdfParameters.set("S",i.ValueType.Bytes,h.random(32));const e=this.dataCipherUuid.toString()===n.CipherId.ChaCha20?12:16;this.encryptionIV=h.random(e)}}setVersion(e){if(3!==e&&4!==e)throw new a.KdbxError(n.ErrorCodes.InvalidArg,"bad file version");this.versionMajor=e,this.versionMinor=y[e],4===this.versionMajor?(this.kdfParameters||this.createKdfParameters(),this.crsAlgorithm=n.CrsAlgorithm.ChaCha20,this.keyEncryptionRounds=void 0):(this.kdfParameters=void 0,this.crsAlgorithm=n.CrsAlgorithm.Salsa20,this.keyEncryptionRounds=n.Defaults.KeyEncryptionRounds)}setKdf(e){this.createKdfParameters(e)}static read(e,t){const r=new g;for(r.readSignature(e),r.readVersion(e);r.readField(e,u,t););return r.endPos=e.pos,r.validate(),r}readInnerHeader(e,t){for(;this.readField(e,f,t););this.validateInner()}static create(){const e=new g;return e.versionMajor=m.DefaultFileVersionMajor,e.versionMinor=y[m.DefaultFileVersionMajor],e.dataCipherUuid=new s.KdbxUuid(n.CipherId.Aes),e.compression=n.CompressionAlgorithm.GZip,e.crsAlgorithm=n.CrsAlgorithm.ChaCha20,e.createKdfParameters(),e}}t.KdbxHeader=g,g.MaxFileVersion=m.MaxSupportedVersion},296:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.KdbxMeta=void 0;const n=r(552),s=r(943),i=r(638),o=r(596),a=r(325),d=r(513),h=r(968),l="KdbxWeb";class c{constructor(){this._memoryProtection={},this.customData=new Map,this.customIcons=new Map}get editState(){return this._editState}set editState(e){this._editState=e}getOrCreateEditState(){return this._editState||(this._editState={}),this._editState}get name(){return this._name}set name(e){e!==this._name&&(this._name=e,this.nameChanged=new Date)}get desc(){return this._desc}set desc(e){e!==this._desc&&(this._desc=e,this.descChanged=new Date)}get defaultUser(){return this._defaultUser}set defaultUser(e){e!==this._defaultUser&&(this._defaultUser=e,this.defaultUserChanged=new Date)}get mntncHistoryDays(){return this._mntncHistoryDays}set mntncHistoryDays(e){e!==this._mntncHistoryDays&&(this._mntncHistoryDays=e,this.getOrCreateEditState().mntncHistoryDaysChanged=new Date)}get color(){return this._color}set color(e){e!==this._color&&(this._color=e,this.getOrCreateEditState().colorChanged=new Date)}get keyChangeRec(){return this._keyChangeRec}set keyChangeRec(e){e!==this._keyChangeRec&&(this._keyChangeRec=e,this.getOrCreateEditState().keyChangeRecChanged=new Date)}get keyChangeForce(){return this._keyChangeForce}set keyChangeForce(e){e!==this._keyChangeForce&&(this._keyChangeForce=e,this.getOrCreateEditState().keyChangeForceChanged=new Date)}get recycleBinEnabled(){return this._recycleBinEnabled}set recycleBinEnabled(e){e!==this._recycleBinEnabled&&(this._recycleBinEnabled=e,this.recycleBinChanged=new Date)}get recycleBinUuid(){return this._recycleBinUuid}set recycleBinUuid(e){e!==this._recycleBinUuid&&(this._recycleBinUuid=e,this.recycleBinChanged=new Date)}get entryTemplatesGroup(){return this._entryTemplatesGroup}set entryTemplatesGroup(e){e!==this._entryTemplatesGroup&&(this._entryTemplatesGroup=e,this.entryTemplatesGroupChanged=new Date)}get historyMaxItems(){return this._historyMaxItems}set historyMaxItems(e){e!==this._historyMaxItems&&(this._historyMaxItems=e,this.getOrCreateEditState().historyMaxItemsChanged=new Date)}get historyMaxSize(){return this._historyMaxSize}set historyMaxSize(e){e!==this._historyMaxSize&&(this._historyMaxSize=e,this.getOrCreateEditState().historyMaxSizeChanged=new Date)}get lastSelectedGroup(){return this._lastSelectedGroup}set lastSelectedGroup(e){e!==this._lastSelectedGroup&&(this._lastSelectedGroup=e,this.getOrCreateEditState().lastSelectedGroupChanged=new Date)}get lastTopVisibleGroup(){return this._lastTopVisibleGroup}set lastTopVisibleGroup(e){e!==this._lastTopVisibleGroup&&(this._lastTopVisibleGroup=e,this.getOrCreateEditState().lastTopVisibleGroupChanged=new Date)}get memoryProtection(){return this._memoryProtection}set memoryProtection(e){e!==this._memoryProtection&&(this._memoryProtection=e,this.getOrCreateEditState().memoryProtectionChanged=new Date)}readNode(e,t){var r;switch(e.tagName){case i.Elem.Generator:this.generator=s.getText(e);break;case i.Elem.HeaderHash:this.headerHash=s.getBytes(e);break;case i.Elem.SettingsChanged:this.settingsChanged=s.getDate(e);break;case i.Elem.DbName:this._name=s.getText(e);break;case i.Elem.DbNameChanged:this.nameChanged=s.getDate(e);break;case i.Elem.DbDesc:this._desc=s.getText(e);break;case i.Elem.DbDescChanged:this.descChanged=s.getDate(e);break;case i.Elem.DbDefaultUser:this._defaultUser=s.getText(e);break;case i.Elem.DbDefaultUserChanged:this.defaultUserChanged=s.getDate(e);break;case i.Elem.DbMntncHistoryDays:this._mntncHistoryDays=s.getNumber(e);break;case i.Elem.DbColor:this._color=s.getText(e);break;case i.Elem.DbKeyChanged:this.keyChanged=s.getDate(e);break;case i.Elem.DbKeyChangeRec:this._keyChangeRec=s.getNumber(e);break;case i.Elem.DbKeyChangeForce:this._keyChangeForce=s.getNumber(e);break;case i.Elem.RecycleBinEnabled:this._recycleBinEnabled=null!==(r=s.getBoolean(e))&&void 0!==r?r:void 0;break;case i.Elem.RecycleBinUuid:this._recycleBinUuid=s.getUuid(e);break;case i.Elem.RecycleBinChanged:this.recycleBinChanged=s.getDate(e);break;case i.Elem.EntryTemplatesGroup:this._entryTemplatesGroup=s.getUuid(e);break;case i.Elem.EntryTemplatesGroupChanged:this.entryTemplatesGroupChanged=s.getDate(e);break;case i.Elem.HistoryMaxItems:this._historyMaxItems=s.getNumber(e);break;case i.Elem.HistoryMaxSize:this._historyMaxSize=s.getNumber(e);break;case i.Elem.LastSelectedGroup:this._lastSelectedGroup=s.getUuid(e);break;case i.Elem.LastTopVisibleGroup:this._lastTopVisibleGroup=s.getUuid(e);break;case i.Elem.MemoryProt:this.readMemoryProtection(e);break;case i.Elem.CustomIcons:this.readCustomIcons(e);break;case i.Elem.Binaries:this.readBinaries(e,t);break;case i.Elem.CustomData:this.readCustomData(e)}}readMemoryProtection(e){var t,r,n,o,a;for(let d=0,h=e.childNodes,l=h.length;d<l;d++){const e=h[d];switch(e.tagName){case i.Elem.ProtTitle:this.memoryProtection.title=null!==(t=s.getBoolean(e))&&void 0!==t?t:void 0;break;case i.Elem.ProtUserName:this.memoryProtection.userName=null!==(r=s.getBoolean(e))&&void 0!==r?r:void 0;break;case i.Elem.ProtPassword:this.memoryProtection.password=null!==(n=s.getBoolean(e))&&void 0!==n?n:void 0;break;case i.Elem.ProtUrl:this.memoryProtection.url=null!==(o=s.getBoolean(e))&&void 0!==o?o:void 0;break;case i.Elem.ProtNotes:this.memoryProtection.notes=null!==(a=s.getBoolean(e))&&void 0!==a?a:void 0}}}writeMemoryProtection(e){const t=s.addChildNode(e,i.Elem.MemoryProt);s.setBoolean(s.addChildNode(t,i.Elem.ProtTitle),this.memoryProtection.title),s.setBoolean(s.addChildNode(t,i.Elem.ProtUserName),this.memoryProtection.userName),s.setBoolean(s.addChildNode(t,i.Elem.ProtPassword),this.memoryProtection.password),s.setBoolean(s.addChildNode(t,i.Elem.ProtUrl),this.memoryProtection.url),s.setBoolean(s.addChildNode(t,i.Elem.ProtNotes),this.memoryProtection.notes)}readCustomIcons(e){for(let t=0,r=e.childNodes,n=r.length;t<n;t++){const e=r[t];e.tagName===i.Elem.CustomIconItem&&this.readCustomIcon(e)}}readCustomIcon(e){var t;let r,n,o,a;for(let d=0,h=e.childNodes,l=h.length;d<l;d++){const e=h[d];switch(e.tagName){case i.Elem.CustomIconItemID:r=s.getUuid(e);break;case i.Elem.CustomIconItemData:n=s.getBytes(e);break;case i.Elem.CustomIconItemName:o=null!==(t=s.getText(e))&&void 0!==t?t:void 0;break;case i.Elem.LastModTime:a=s.getDate(e)}}r&&n&&this.customIcons.set(r.id,{data:n,name:o,lastModified:a})}writeCustomIcons(e,t){const r=s.addChildNode(e,i.Elem.CustomIcons);for(const[e,{data:n,name:o,lastModified:a}]of this.customIcons)if(n){const d=s.addChildNode(r,i.Elem.CustomIconItem);s.setUuid(s.addChildNode(d,i.Elem.CustomIconItemID),e),s.setBytes(s.addChildNode(d,i.Elem.CustomIconItemData),n),t.kdbx.versionIsAtLeast(4,1)&&(o&&s.setText(s.addChildNode(d,i.Elem.CustomIconItemName),o),a&&s.setDate(s.addChildNode(d,i.Elem.LastModTime),a))}}readBinaries(e,t){for(let r=0,n=e.childNodes,s=n.length;r<s;r++){const e=n[r];e.tagName===i.Elem.Binary&&this.readBinary(e,t)}}readBinary(e,t){const r=e.getAttribute(i.Attr.Id),n=s.getProtectedBinary(e);if(r&&n){if(h.KdbxBinaries.isKdbxBinaryRef(n))throw new a.KdbxError(d.ErrorCodes.FileCorrupt,"binary ref in meta");t.kdbx.binaries.addWithId(r,n)}}writeBinaries(e,t){const r=s.addChildNode(e,i.Elem.Binaries),n=t.kdbx.binaries.getAll();for(const e of n){const t=s.addChildNode(r,i.Elem.Binary);t.setAttribute(i.Attr.Id,e.ref),s.setProtectedBinary(t,e.value)}}readCustomData(e){this.customData=o.KdbxCustomData.read(e)}writeCustomData(e,t){o.KdbxCustomData.write(e,t,this.customData)}write(e,t){this.generator=l;const r=s.addChildNode(e,i.Elem.Meta);s.setText(s.addChildNode(r,i.Elem.Generator),l),t.kdbx.versionMajor<4?s.setBytes(s.addChildNode(r,i.Elem.HeaderHash),this.headerHash):this.settingsChanged&&t.setXmlDate(s.addChildNode(r,i.Elem.SettingsChanged),this.settingsChanged),s.setText(s.addChildNode(r,i.Elem.DbName),this.name),t.setXmlDate(s.addChildNode(r,i.Elem.DbNameChanged),this.nameChanged),s.setText(s.addChildNode(r,i.Elem.DbDesc),this.desc),t.setXmlDate(s.addChildNode(r,i.Elem.DbDescChanged),this.descChanged),s.setText(s.addChildNode(r,i.Elem.DbDefaultUser),this.defaultUser),t.setXmlDate(s.addChildNode(r,i.Elem.DbDefaultUserChanged),this.defaultUserChanged),s.setNumber(s.addChildNode(r,i.Elem.DbMntncHistoryDays),this.mntncHistoryDays),s.setText(s.addChildNode(r,i.Elem.DbColor),this.color),t.setXmlDate(s.addChildNode(r,i.Elem.DbKeyChanged),this.keyChanged),s.setNumber(s.addChildNode(r,i.Elem.DbKeyChangeRec),this.keyChangeRec),s.setNumber(s.addChildNode(r,i.Elem.DbKeyChangeForce),this.keyChangeForce),s.setBoolean(s.addChildNode(r,i.Elem.RecycleBinEnabled),this.recycleBinEnabled),s.setUuid(s.addChildNode(r,i.Elem.RecycleBinUuid),this.recycleBinUuid),t.setXmlDate(s.addChildNode(r,i.Elem.RecycleBinChanged),this.recycleBinChanged),s.setUuid(s.addChildNode(r,i.Elem.EntryTemplatesGroup),this.entryTemplatesGroup),t.setXmlDate(s.addChildNode(r,i.Elem.EntryTemplatesGroupChanged),this.entryTemplatesGroupChanged),s.setNumber(s.addChildNode(r,i.Elem.HistoryMaxItems),this.historyMaxItems),s.setNumber(s.addChildNode(r,i.Elem.HistoryMaxSize),this.historyMaxSize),s.setUuid(s.addChildNode(r,i.Elem.LastSelectedGroup),this.lastSelectedGroup),s.setUuid(s.addChildNode(r,i.Elem.LastTopVisibleGroup),this.lastTopVisibleGroup),this.writeMemoryProtection(r),this.writeCustomIcons(r,t),(t.exportXml||t.kdbx.versionMajor<4)&&this.writeBinaries(r,t),this.writeCustomData(r,t)}merge(e,t){var r,n,s,i,o,a;this.needUpdate(e.nameChanged,this.nameChanged)&&(this._name=e.name,this.nameChanged=e.nameChanged),this.needUpdate(e.descChanged,this.descChanged)&&(this._desc=e.desc,this.descChanged=e.descChanged),this.needUpdate(e.defaultUserChanged,this.defaultUserChanged)&&(this._defaultUser=e.defaultUser,this.defaultUserChanged=e.defaultUserChanged),this.needUpdate(e.keyChanged,this.keyChanged)&&(this.keyChanged=e.keyChanged),this.needUpdate(e.settingsChanged,this.settingsChanged)&&(this.settingsChanged=e.settingsChanged),this.needUpdate(e.recycleBinChanged,this.recycleBinChanged)&&(this._recycleBinEnabled=e.recycleBinEnabled,this._recycleBinUuid=e.recycleBinUuid,this.recycleBinChanged=e.recycleBinChanged),this.needUpdate(e.entryTemplatesGroupChanged,this.entryTemplatesGroupChanged)&&(this._entryTemplatesGroup=e.entryTemplatesGroup,this.entryTemplatesGroupChanged=e.entryTemplatesGroupChanged),this.mergeMapWithDates(this.customData,e.customData,t),this.mergeMapWithDates(this.customIcons,e.customIcons,t),(null===(r=this._editState)||void 0===r?void 0:r.historyMaxItemsChanged)||(this.historyMaxItems=e.historyMaxItems),(null===(n=this._editState)||void 0===n?void 0:n.historyMaxSizeChanged)||(this.historyMaxSize=e.historyMaxSize),(null===(s=this._editState)||void 0===s?void 0:s.keyChangeRecChanged)||(this.keyChangeRec=e.keyChangeRec),(null===(i=this._editState)||void 0===i?void 0:i.keyChangeForceChanged)||(this.keyChangeForce=e.keyChangeForce),(null===(o=this._editState)||void 0===o?void 0:o.mntncHistoryDaysChanged)||(this.mntncHistoryDays=e.mntncHistoryDays),(null===(a=this._editState)||void 0===a?void 0:a.colorChanged)||(this.color=e.color)}mergeMapWithDates(e,t,r){for(const[n,s]of t){const t=e.get(n);t?t.lastModified&&s.lastModified&&s.lastModified>t.lastModified&&e.set(n,s):r.deleted.has(n)||e.set(n,s)}}needUpdate(e,t){return!!e&&(!t||e>t)}static create(){const e=new Date,t=new c;return t.generator=l,t.settingsChanged=e,t.mntncHistoryDays=d.Defaults.MntncHistoryDays,t.recycleBinEnabled=!0,t.historyMaxItems=d.Defaults.HistoryMaxItems,t.historyMaxSize=d.Defaults.HistoryMaxSize,t.nameChanged=e,t.descChanged=e,t.defaultUserChanged=e,t.recycleBinChanged=e,t.keyChangeRec=-1,t.keyChangeForce=-1,t.entryTemplatesGroup=new n.KdbxUuid,t.entryTemplatesGroupChanged=e,t.memoryProtection={title:!1,userName:!1,password:!0,url:!1,notes:!1},t}static read(e,t){const r=new c;for(let n=0,s=e.childNodes,i=s.length;n<i;n++){const e=s[n];e.tagName&&r.readNode(e,t)}return r}}t.KdbxMeta=c},554:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.KdbxTimes=void 0;const n=r(638),s=r(943);class i{readNode(e){switch(e.tagName){case n.Elem.CreationTime:this.creationTime=s.getDate(e);break;case n.Elem.LastModTime:this.lastModTime=s.getDate(e);break;case n.Elem.LastAccessTime:this.lastAccessTime=s.getDate(e);break;case n.Elem.ExpiryTime:this.expiryTime=s.getDate(e);break;case n.Elem.Expires:this.expires=s.getBoolean(e);break;case n.Elem.UsageCount:this.usageCount=s.getNumber(e);break;case n.Elem.LocationChanged:this.locationChanged=s.getDate(e)}}clone(){const e=new i;return e.creationTime=this.creationTime,e.lastModTime=this.lastModTime,e.lastAccessTime=this.lastAccessTime,e.expiryTime=this.expiryTime,e.expires=this.expires,e.usageCount=this.usageCount,e.locationChanged=this.locationChanged,e}update(){const e=new Date;this.lastModTime=e,this.lastAccessTime=e}write(e,t){const r=s.addChildNode(e,n.Elem.Times);t.setXmlDate(s.addChildNode(r,n.Elem.CreationTime),this.creationTime),t.setXmlDate(s.addChildNode(r,n.Elem.LastModTime),this.lastModTime),t.setXmlDate(s.addChildNode(r,n.Elem.LastAccessTime),this.lastAccessTime),t.setXmlDate(s.addChildNode(r,n.Elem.ExpiryTime),this.expiryTime),s.setBoolean(s.addChildNode(r,n.Elem.Expires),this.expires),s.setNumber(s.addChildNode(r,n.Elem.UsageCount),this.usageCount),t.setXmlDate(s.addChildNode(r,n.Elem.LocationChanged),this.locationChanged)}static create(){const e=new i,t=new Date;return e.creationTime=t,e.lastModTime=t,e.lastAccessTime=t,e.expiryTime=t,e.expires=!1,e.usageCount=0,e.locationChanged=t,e}static read(e){const t=new i;for(let r=0,n=e.childNodes,s=n.length;r<s;r++){const e=n[r];e.tagName&&t.readNode(e)}return t}}t.KdbxTimes=i},552:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.KdbxUuid=void 0;const n=r(100),s=r(513),i=r(325),o=r(613);class a{constructor(e){if(void 0===e?e=new ArrayBuffer(16):"string"==typeof e&&(e=(0,n.base64ToBytes)(e)),16!==e.byteLength)throw new i.KdbxError(s.ErrorCodes.FileCorrupt,`bad UUID length: ${e.byteLength}`);this.id=(0,n.bytesToBase64)(e),this.empty="AAAAAAAAAAAAAAAAAAAAAA=="===this.id}equals(e){return e&&e.toString()===this.toString()||!1}get bytes(){return this.toBytes()}static random(){return new a(o.random(16))}toString(){return this.id}valueOf(){return this.id}toBytes(){return(0,n.base64ToBytes)(this.id)}}t.KdbxUuid=a},131:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Kdbx=void 0;const n=r(638),s=r(943),i=r(968),o=r(414),a=r(171),d=r(296),h=r(374),l=r(447),c=r(325),u=r(513),f=r(257),m=r(270),y=r(552);class p{constructor(){this.header=new l.KdbxHeader,this.credentials=new h.KdbxCredentials(null),this.meta=new d.KdbxMeta,this.binaries=new i.KdbxBinaries,this.groups=[],this.deletedObjects=[]}get versionMajor(){return this.header.versionMajor}get versionMinor(){return this.header.versionMinor}static create(e,t){if(!(e instanceof h.KdbxCredentials))throw new c.KdbxError(u.ErrorCodes.InvalidArg,"credentials");const r=new p;return r.credentials=e,r.header=l.KdbxHeader.create(),r.meta=d.KdbxMeta.create(),r.meta._name=t,r.createDefaultGroup(),r.createRecycleBin(),r.meta._lastSelectedGroup=r.getDefaultGroup().uuid,r.meta._lastTopVisibleGroup=r.getDefaultGroup().uuid,r}static load(e,t,r){if(!(e instanceof ArrayBuffer))return Promise.reject(new c.KdbxError(u.ErrorCodes.InvalidArg,"data"));if(!(t instanceof h.KdbxCredentials))return Promise.reject(new c.KdbxError(u.ErrorCodes.InvalidArg,"credentials"));const n=new p;n.credentials=t;const s=new f.KdbxFormat(n);return s.preserveXml=(null==r?void 0:r.preserveXml)||!1,s.load(e)}static loadXml(e,t){if("string"!=typeof e)return Promise.reject(new c.KdbxError(u.ErrorCodes.InvalidArg,"data"));if(!(t instanceof h.KdbxCredentials))return Promise.reject(new c.KdbxError(u.ErrorCodes.InvalidArg,"credentials"));const r=new p;r.credentials=t;return new f.KdbxFormat(r).loadXml(e)}save(){return new f.KdbxFormat(this).save()}saveXml(e=!1){return new f.KdbxFormat(this).saveXml(e)}createDefaultGroup(){if(this.groups.length)return;const e=a.KdbxGroup.create(this.meta.name||"");e.icon=u.Icons.FolderOpen,e.expanded=!0,this.groups.push(e)}createRecycleBin(){if(this.meta.recycleBinEnabled=!0,this.meta.recycleBinUuid&&this.getGroup(this.meta.recycleBinUuid))return;const e=this.getDefaultGroup(),t=a.KdbxGroup.create(u.Defaults.RecycleBinName,e);t.icon=u.Icons.TrashBin,t.enableAutoType=!1,t.enableSearching=!1,this.meta.recycleBinUuid=t.uuid,e.groups.push(t)}createGroup(e,t){const r=a.KdbxGroup.create(t,e);return e.groups.push(r),r}createEntry(e){const t=m.KdbxEntry.create(this.meta,e);return e.entries.push(t),t}getDefaultGroup(){if(!this.groups[0])throw new c.KdbxError(u.ErrorCodes.InvalidState,"empty default group");return this.groups[0]}getGroup(e,t){const r=t?t.groups:this.groups;for(const t of r){if(t.uuid.equals(e))return t;const r=this.getGroup(e,t);if(r)return r}}move(e,t,r){var n,s;const i=e instanceof a.KdbxGroup?"groups":"entries",o=null===(n=e.parentGroup)||void 0===n?void 0:n[i],d=null==o?void 0:o.indexOf(e);if(!("number"!=typeof d||d<0)){if(o.splice(d,1),t){const n=t[i];"number"==typeof r&&r>=0?n.splice(r,0,e):n.push(e)}else{const t=new Date;if(e instanceof a.KdbxGroup)for(const r of e.allGroupsAndEntries()){const e=r.uuid;this.addDeletedObject(e,t)}else e.uuid&&this.addDeletedObject(e.uuid,t)}e.previousParentGroup=null===(s=e.parentGroup)||void 0===s?void 0:s.uuid,e.parentGroup=null!=t?t:void 0,e.times.locationChanged=new Date}}addDeletedObject(e,t){const r=new o.KdbxDeletedObject;r.uuid=e,r.deletionTime=t,this.deletedObjects.push(r)}remove(e){let t;this.meta.recycleBinEnabled&&this.meta.recycleBinUuid&&(this.createRecycleBin(),t=this.getGroup(this.meta.recycleBinUuid)),this.move(e,t)}createBinary(e){return this.binaries.add(e)}importEntry(e,t,r){const n=new m.KdbxEntry,s=y.KdbxUuid.random();n.copyFrom(e),n.uuid=s;for(const t of e.history){const e=new m.KdbxEntry;e.copyFrom(t),e.uuid=s,n.history.push(e)}const o=new Map,a=new Set;for(const e of n.history.concat(n)){e.customIcon&&a.add(e.customIcon.id);for(const t of e.binaries.values())i.KdbxBinaries.isKdbxBinaryWithHash(t)&&o.set(t.hash,t)}for(const e of o.values()){r.binaries.getValueByHash(e.hash)&&!this.binaries.getValueByHash(e.hash)&&this.binaries.addWithHash(e)}for(const e of a){const t=r.meta.customIcons.get(e);t&&this.meta.customIcons.set(e,t)}return t.entries.push(n),n.parentGroup=t,n.times.update(),n}cleanup(e){const t=new Date,r=(null==e?void 0:e.historyRules)&&"number"==typeof this.meta.historyMaxItems&&this.meta.historyMaxItems>=0?this.meta.historyMaxItems:1/0,n=new Set,s=new Set,o=e=>{e.customIcon&&n.add(e.customIcon.id);for(const t of e.binaries.values())i.KdbxBinaries.isKdbxBinaryWithHash(t)&&s.add(t.hash)};for(const e of this.getDefaultGroup().allGroupsAndEntries())if(e instanceof m.KdbxEntry){if(e.history.length>r&&e.removeHistory(0,e.history.length-r),o(e),e.history)for(const t of e.history)o(t)}else e.customIcon&&n.add(e.customIcon.id);if(null==e?void 0:e.customIcons)for(const e of this.meta.customIcons.keys())if(!n.has(e)){const r=new y.KdbxUuid(e);this.addDeletedObject(r,t),this.meta.customIcons.delete(e)}if(null==e?void 0:e.binaries)for(const e of this.binaries.getAllWithHashes())s.has(e.hash)||this.binaries.deleteWithHash(e.hash)}merge(e){const t=this.getDefaultGroup(),r=e.getDefaultGroup();if(!t||!r)throw new c.KdbxError(u.ErrorCodes.MergeError,"no default group");if(!t.uuid.equals(r.uuid))throw new c.KdbxError(u.ErrorCodes.MergeError,"default group is different");const n=this.getObjectMap();for(const t of e.deletedObjects)t.uuid&&t.deletionTime&&!n.deleted.has(t.uuid.id)&&(this.deletedObjects.push(t),n.deleted.set(t.uuid.id,t.deletionTime));for(const t of e.binaries.getAllWithHashes())this.binaries.getValueByHash(t.hash)||this.binaries.addWithHash(t);const s=e.getObjectMap();n.remoteEntries=s.entries,n.remoteGroups=s.groups,this.meta.merge(e.meta,n),t.merge(n),this.cleanup({historyRules:!0,customIcons:!0,binaries:!0})}getLocalEditState(){const e={entries:{}};for(const t of this.getDefaultGroup().allEntries())t._editState&&t.uuid&&e.entries&&(e.entries[t.uuid.id]=t._editState);return this.meta._editState&&(e.meta=this.meta._editState),e}setLocalEditState(e){var t;for(const r of this.getDefaultGroup().allEntries())(null===(t=e.entries)||void 0===t?void 0:t[r.uuid.id])&&(r._editState=e.entries[r.uuid.id]);e.meta&&(this.meta._editState=e.meta)}removeLocalEditState(){for(const e of this.getDefaultGroup().allEntries())e._editState=void 0;this.meta._editState=void 0}upgrade(){this.setVersion(l.KdbxHeader.MaxFileVersion)}setVersion(e){this.meta.headerHash=void 0,this.meta.settingsChanged=new Date,this.header.setVersion(e)}setKdf(e){this.meta.headerHash=void 0,this.meta.settingsChanged=new Date,this.header.setKdf(e)}getObjectMap(){const e={entries:new Map,groups:new Map,remoteEntries:new Map,remoteGroups:new Map,deleted:new Map};for(const t of this.getDefaultGroup().allGroupsAndEntries()){if(e.entries.has(t.uuid.id))throw new c.KdbxError(u.ErrorCodes.MergeError,`duplicate: ${t.uuid}`);t instanceof m.KdbxEntry?e.entries.set(t.uuid.id,t):e.groups.set(t.uuid.id,t)}for(const t of this.deletedObjects)t.uuid&&t.deletionTime&&e.deleted.set(t.uuid.id,t.deletionTime);return e}loadFromXml(e){if(!this.xml)throw new c.KdbxError(u.ErrorCodes.InvalidState,"xml is not set");if(this.xml.documentElement.tagName!==n.Elem.DocNode)throw new c.KdbxError(u.ErrorCodes.FileCorrupt,"bad xml root");return this.parseMeta(e),this.binaries.computeHashes().then((()=>(this.parseRoot(e),this)))}parseMeta(e){if(!this.xml)throw new c.KdbxError(u.ErrorCodes.InvalidState,"xml is not set");const t=s.getChildNode(this.xml.documentElement,n.Elem.Meta,"no meta node");this.meta=d.KdbxMeta.read(t,e)}parseRoot(e){if(!this.xml)throw new c.KdbxError(u.ErrorCodes.InvalidState,"xml is not set");this.groups=[],this.deletedObjects=[];for(let t=0,r=s.getChildNode(this.xml.documentElement,n.Elem.Root,"no root node").childNodes,i=r.length;t<i;t++){const s=r[t];switch(s.tagName){case n.Elem.Group:this.readGroup(s,e);break;case n.Elem.DeletedObjects:this.readDeletedObjects(s)}}}readDeletedObjects(e){for(let t=0,r=e.childNodes,s=r.length;t<s;t++){const e=r[t];switch(e.tagName){case n.Elem.DeletedObject:this.deletedObjects.push(o.KdbxDeletedObject.read(e))}}}readGroup(e,t){this.groups.push(a.KdbxGroup.read(e,t))}buildXml(e){const t=s.create(n.Elem.DocNode);this.meta.write(t.documentElement,e);const r=s.addChildNode(t.documentElement,n.Elem.Root);for(const t of this.groups)t.write(r,e);const i=s.addChildNode(r,n.Elem.DeletedObjects);for(const t of this.deletedObjects)t.write(i,e);this.xml=t}versionIsAtLeast(e,t){return this.versionMajor>e||this.versionMajor===e&&this.versionMinor>=t}}t.Kdbx=p},909:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BinaryStream=void 0;t.BinaryStream=class{constructor(e){this._arrayBuffer=e||new ArrayBuffer(1024),this._dataView=new DataView(this._arrayBuffer),this._pos=0,this._canExpand=!e}get pos(){return this._pos}get byteLength(){return this._arrayBuffer.byteLength}readBytes(e){const t=this._arrayBuffer.slice(this._pos,this._pos+e);return this._pos+=e,t}readBytesToEnd(){const e=this._arrayBuffer.byteLength-this._pos;return this.readBytes(e)}readBytesNoAdvance(e,t){return this._arrayBuffer.slice(e,t)}writeBytes(e){const t=e instanceof ArrayBuffer?new Uint8Array(e):e;this.checkCapacity(t.length),new Uint8Array(this._arrayBuffer).set(t,this._pos),this._pos+=t.length}getWrittenBytes(){return this._arrayBuffer.slice(0,this._pos)}checkCapacity(e){const t=this._arrayBuffer.byteLength-this._pos;if(this._canExpand&&t<e){let t=this._arrayBuffer.byteLength;const r=this._pos+e;for(;t<r;)t*=2;const n=new Uint8Array(t);n.set(new Uint8Array(this._arrayBuffer)),this._arrayBuffer=n.buffer,this._dataView=new DataView(this._arrayBuffer)}}getInt8(){const e=this._dataView.getInt8(this._pos);return this._pos+=1,e}setInt8(e){this.checkCapacity(1),this._dataView.setInt8(this._pos,e),this._pos+=1}getUint8(){const e=this._dataView.getUint8(this._pos);return this._pos+=1,e}setUint8(e){this.checkCapacity(1),this._dataView.setUint8(this._pos,e),this._pos+=1}getInt16(e){const t=this._dataView.getInt16(this._pos,e);return this._pos+=2,t}setInt16(e,t){this.checkCapacity(2),this._dataView.setInt16(this._pos,e,t),this._pos+=2}getUint16(e){const t=this._dataView.getUint16(this._pos,e);return this._pos+=2,t}setUint16(e,t){this.checkCapacity(2),this._dataView.setUint16(this._pos,e,t),this._pos+=2}getInt32(e){const t=this._dataView.getInt32(this._pos,e);return this._pos+=4,t}setInt32(e,t){this.checkCapacity(4),this._dataView.setInt32(this._pos,e,t),this._pos+=4}getUint32(e){const t=this._dataView.getUint32(this._pos,e);return this._pos+=4,t}setUint32(e,t){this.checkCapacity(4),this._dataView.setUint32(this._pos,e,t),this._pos+=4}getFloat32(e){const t=this._dataView.getFloat32(this._pos,e);return this._pos+=4,t}setFloat32(e,t){this.checkCapacity(4),this._dataView.setFloat32(this._pos,e,t),this._pos+=4}getFloat64(e){const t=this._dataView.getFloat64(this._pos,e);return this._pos+=8,t}setFloat64(e,t){this.checkCapacity(8),this._dataView.setFloat64(this._pos,e,t),this._pos+=8}getUint64(e){let t=this.getUint32(e),r=this.getUint32(e);return e?r*=4294967296:t*=4294967296,t+r}setUint64(e,t){t?(this.setUint32(4294967295&e,!0),this.setUint32(Math.floor(e/4294967296),!0)):(this.checkCapacity(8),this.setUint32(Math.floor(e/4294967296),!1),this.setUint32(4294967295&e,!1))}}},100:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.zeroBuffer=t.arrayToBuffer=t.bytesToHex=t.hexToBytes=t.bytesToBase64=t.base64ToBytes=t.stringToBytes=t.bytesToString=t.arrayBufferEquals=void 0;const r=new TextEncoder,n=new TextDecoder;t.arrayBufferEquals=function(e,t){if(e.byteLength!==t.byteLength)return!1;const r=new Uint8Array(e),n=new Uint8Array(t);for(let e=0,t=r.length;e<t;e++)if(r[e]!==n[e])return!1;return!0},t.bytesToString=function(e){return e instanceof ArrayBuffer&&(e=new Uint8Array(e)),n.decode(e)},t.stringToBytes=function(e){return r.encode(e)},t.base64ToBytes=function(e){if("function"==typeof atob){const t=atob(e),r=new Uint8Array(t.length);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);return r}{const t=Buffer.from(e,"base64");return new Uint8Array(t)}},t.bytesToBase64=function(e){const t=e instanceof ArrayBuffer?new Uint8Array(e):e;if("function"==typeof btoa){let e="";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return btoa(e)}return Buffer.from(e).toString("base64")},t.hexToBytes=function(e){const t=new Uint8Array(Math.ceil(e.length/2));for(let r=0;r<t.length;r++)t[r]=parseInt(e.substr(2*r,2),16);return t},t.bytesToHex=function(e){const t=e instanceof ArrayBuffer?new Uint8Array(e):e;let r="";for(let e=0;e<t.length;e++){const n=t[e].toString(16);1===n.length&&(r+="0"),r+=n}return r},t.arrayToBuffer=function(e){if(e instanceof ArrayBuffer)return e;const t=e.buffer;return 0===e.byteOffset&&e.byteLength===t.byteLength?t:e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)},t.zeroBuffer=function(e){(e instanceof ArrayBuffer?new Uint8Array(e):e).fill(0)}},880:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Int64=void 0;class r{constructor(e=0,t=0){this.lo=e,this.hi=t}get value(){if(this.hi){if(this.hi>=2097152)throw new Error("too large number");return 4294967296*this.hi+this.lo}return this.lo}valueOf(){return this.value}static from(e){if(e>9007199254740991)throw new Error("too large number");const t=e>>>0;return new r(t,(e-t)/4294967296>>>0)}}t.Int64=r},336:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.VarDictionary=t.ValueType=void 0;const n=r(325),s=r(513),i=r(100),o=r(880);var a;!function(e){e[e.UInt32=4]="UInt32",e[e.UInt64=5]="UInt64",e[e.Bool=8]="Bool",e[e.Int32=12]="Int32",e[e.Int64=13]="Int64",e[e.String=24]="String",e[e.Bytes=66]="Bytes"}(a=t.ValueType||(t.ValueType={}));class d{constructor(){this._items=[],this._map=new Map}keys(){return this._items.map((e=>e.key))}get length(){return this._items.length}get(e){const t=this._map.get(e);return t?t.value:void 0}set(e,t,r){let d;switch(t){case a.UInt32:if("number"!=typeof r||r<0)throw new n.KdbxError(s.ErrorCodes.InvalidArg);d={key:e,type:t,value:r};break;case a.UInt64:if(!(r instanceof o.Int64))throw new n.KdbxError(s.ErrorCodes.InvalidArg);d={key:e,type:t,value:r};break;case a.Bool:if("boolean"!=typeof r)throw new n.KdbxError(s.ErrorCodes.InvalidArg);d={key:e,type:t,value:r};break;case a.Int32:if("number"!=typeof r)throw new n.KdbxError(s.ErrorCodes.InvalidArg);d={key:e,type:t,value:r};break;case a.Int64:if(!(r instanceof o.Int64))throw new n.KdbxError(s.ErrorCodes.InvalidArg);d={key:e,type:t,value:r};break;case a.String:if("string"!=typeof r)throw new n.KdbxError(s.ErrorCodes.InvalidArg);d={key:e,type:t,value:r};break;case a.Bytes:if(r instanceof Uint8Array&&(r=(0,i.arrayToBuffer)(r)),!(r instanceof ArrayBuffer))throw new n.KdbxError(s.ErrorCodes.InvalidArg);d={key:e,type:t,value:r};break;default:throw new n.KdbxError(s.ErrorCodes.InvalidArg)}const h=this._map.get(e);if(h){const e=this._items.indexOf(h);this._items.splice(e,1,d)}else this._items.push(d);this._map.set(e,d)}remove(e){this._items=this._items.filter((t=>t.key!==e)),this._map.delete(e)}static read(e){const t=new d;t.readVersion(e);for(let r;r=t.readItem(e);)t._items.push(r),t._map.set(r.key,r);return t}readVersion(e){e.getUint8();const t=e.getUint8();if(0===t||t>1)throw new n.KdbxError(s.ErrorCodes.InvalidVersion)}readItem(e){const t=e.getUint8();if(!t)return;const r=e.getInt32(!0);if(r<=0)throw new n.KdbxError(s.ErrorCodes.FileCorrupt,"bad key length");const d=(0,i.bytesToString)(e.readBytes(r)),h=e.getInt32(!0);if(h<0)throw new n.KdbxError(s.ErrorCodes.FileCorrupt,"bad value length");switch(t){case a.UInt32:if(4!==h)throw new n.KdbxError(s.ErrorCodes.FileCorrupt,"bad uint32");return{key:d,type:t,value:e.getUint32(!0)};case a.UInt64:{if(8!==h)throw new n.KdbxError(s.ErrorCodes.FileCorrupt,"bad uint64");const r=e.getUint32(!0),i=e.getUint32(!0);return{key:d,type:t,value:new o.Int64(r,i)}}case a.Bool:if(1!==h)throw new n.KdbxError(s.ErrorCodes.FileCorrupt,"bad bool");return{key:d,type:t,value:0!==e.getUint8()};case a.Int32:if(4!==h)throw new n.KdbxError(s.ErrorCodes.FileCorrupt,"bad int32");return{key:d,type:t,value:e.getInt32(!0)};case a.Int64:{if(8!==h)throw new n.KdbxError(s.ErrorCodes.FileCorrupt,"bad int64");const r=e.getUint32(!0),i=e.getUint32(!0);return{key:d,type:t,value:new o.Int64(r,i)}}case a.String:return{key:d,type:t,value:(0,i.bytesToString)(e.readBytes(h))};case a.Bytes:return{key:d,type:t,value:e.readBytes(h)};default:throw new n.KdbxError(s.ErrorCodes.FileCorrupt,`bad value type: ${t}`)}}write(e){this.writeVersion(e);for(const t of this._items)this.writeItem(e,t);e.setUint8(0)}writeVersion(e){e.setUint16(256,!0)}writeItem(e,t){e.setUint8(t.type);const r=(0,i.stringToBytes)(t.key);switch(e.setInt32(r.length,!0),e.writeBytes(r),t.type){case a.UInt32:e.setInt32(4,!0),e.setUint32(t.value,!0);break;case a.UInt64:e.setInt32(8,!0),e.setUint32(t.value.lo,!0),e.setUint32(t.value.hi,!0);break;case a.Bool:e.setInt32(1,!0),e.setUint8(t.value?1:0);break;case a.Int32:e.setInt32(4,!0),e.setInt32(t.value,!0);break;case a.Int64:e.setInt32(8,!0),e.setUint32(t.value.lo,!0),e.setUint32(t.value.hi,!0);break;case a.String:{const r=(0,i.stringToBytes)(t.value);e.setInt32(r.length,!0),e.writeBytes(r);break}case a.Bytes:{const r=(0,i.arrayToBuffer)(t.value);e.setInt32(r.byteLength,!0),e.writeBytes(r);break}default:throw new n.KdbxError(s.ErrorCodes.Unsupported)}}}t.VarDictionary=d,d.ValueType=a},943:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.protectPlainValues=t.protectUnprotectedValues=t.unprotectValues=t.updateProtectedValuesSalt=t.setProtectedValues=t.traverse=t.setProtectedBinary=t.getProtectedBinary=t.setProtectedText=t.getProtectedText=t.setUuid=t.getUuid=t.strToBoolean=t.setBoolean=t.getBoolean=t.setNumber=t.getNumber=t.setDate=t.getDate=t.setBytes=t.getBytes=t.setTags=t.getTags=t.setText=t.getText=t.addChildNode=t.getChildNode=t.create=t.serialize=t.parse=void 0;const n=r(547),s=r(325),i=r(513),o=r(638),a=r(100),d=r(880),h=r(552),l=r(758),c=r(968),u=/\.\d\d\d/,f=62135596800,m=/\s*[;,:]\s*/;function y(e){const t=function(){if(r.g.DOMParser)return new r.g.DOMParser;const{DOMParser:e}=r(349);return new e({errorHandler:{warning:e=>{throw e},error:e=>{throw e},fatalError:e=>{throw e}}})}();let n;e=e.replace(/[\x00-\x09\x0B-\x0C\x0E-\x1F]/g,"");try{n=t.parseFromString(e,"application/xml")}catch(e){const t=e instanceof Error?e.message:String(e);throw new s.KdbxError(i.ErrorCodes.FileCorrupt,`bad xml: ${t}`)}if(!n.documentElement)throw new s.KdbxError(i.ErrorCodes.FileCorrupt,"bad xml");const o=n.getElementsByTagName("parsererror")[0];if(o)throw new s.KdbxError(i.ErrorCodes.FileCorrupt,`bad xml: ${o.textContent}`);return n}function p(e,t){const r=e.childNodes.length;if(0===r)return;const n="\n"+"    ".repeat(t),s=t>0?"\n"+"    ".repeat(t-1):"",i=e.ownerDocument||e,o=[];let a;for(let t=0;t<r;t++)a=e.childNodes[t],a.nodeType!==i.TEXT_NODE&&a.nodeType!==i.PROCESSING_INSTRUCTION_NODE&&o.push(a);for(let r=0;r<o.length;r++){a=o[r];if(!(0===t&&0===r)){const t=i.createTextNode(n);e.insertBefore(t,a)}if(!a.nextSibling&&t>0){const t=i.createTextNode(s);e.appendChild(t)}p(a,t+1)}}function g(e){var t;if(null==e?void 0:e.childNodes)return e.protectedValue?e.protectedValue.getText():null!==(t=e.textContent)&&void 0!==t?t:void 0}function b(e,t){e.textContent=t||""}function v(e){const t=g(e);return t?(0,a.arrayToBuffer)((0,a.base64ToBytes)(t)):void 0}function C(e,t){"string"==typeof t&&(t=(0,a.base64ToBytes)(t)),b(e,t?(0,a.bytesToBase64)((0,a.arrayToBuffer)(t)):void 0)}function w(e){switch(null==e?void 0:e.toLowerCase()){case"true":return!0;case"false":return!1;case"null":return null}}function x(e,t){t(e);for(let r=0,n=e.childNodes,s=n.length;r<s;r++){const e=n[r];e.tagName&&x(e,t)}}t.parse=y,t.serialize=function(e,t=!1){t&&p(e,0);let n=function(){if(r.g.XMLSerializer)return new r.g.XMLSerializer;const{XMLSerializer:e}=r(349);return new e}().serializeToString(e);return t&&n.startsWith("<?")&&(n=n.replace(/^(<\?.*?\?>)</,"$1\n<")),n},t.create=function(e){return y('<?xml version="1.0" encoding="utf-8" standalone="yes"?><'+e+"/>")},t.getChildNode=function(e,t,r){if(e&&e.childNodes)for(let r=0,n=e.childNodes,s=n.length;r<s;r++)if(n[r].tagName===t)return n[r];if(r)throw new s.KdbxError(i.ErrorCodes.FileCorrupt,r);return null},t.addChildNode=function(e,t){return e.appendChild((e.ownerDocument||e).createElement(t))},t.getText=g,t.setText=b,t.getTags=function(e){const t=g(e);return t?t.split(m).map((e=>e.trim())).filter((e=>e)):[]},t.setTags=function(e,t){b(e,t.join(", "))},t.getBytes=v,t.setBytes=C,t.getDate=function(e){const t=g(e);if(!t)return;if(t.indexOf(":")>0)return new Date(t);const r=new DataView((0,a.arrayToBuffer)((0,a.base64ToBytes)(t))),n=new d.Int64(r.getUint32(0,!0),r.getUint32(4,!0)).value;return new Date(1e3*(n-f))},t.setDate=function(e,t,r=!1){if(t)if(r){const r=Math.floor(t.getTime()/1e3)+f,n=new DataView(new ArrayBuffer(8)),s=d.Int64.from(r);n.setUint32(0,s.lo,!0),n.setUint32(4,s.hi,!0),b(e,(0,a.bytesToBase64)(n.buffer))}else b(e,t.toISOString().replace(u,""));else b(e,"")},t.getNumber=function(e){const t=g(e);return t?+t:void 0},t.setNumber=function(e,t){b(e,"number"!=typeof t||isNaN(t)?void 0:t.toString())},t.getBoolean=function(e){const t=g(e);return t?w(t):void 0},t.setBoolean=function(e,t){b(e,void 0===t?"":null===t?"null":t?"True":"False")},t.strToBoolean=w,t.getUuid=function(e){const t=v(e);return t?new h.KdbxUuid(t):void 0},t.setUuid=function(e,t){C(e,t instanceof h.KdbxUuid?t.toBytes():t)},t.getProtectedText=function(e){var t;return null!==(t=e.protectedValue||e.textContent)&&void 0!==t?t:void 0},t.setProtectedText=function(e,t){t instanceof l.ProtectedValue?(e.protectedValue=t,e.setAttribute(o.Attr.Protected,"True")):b(e,t)},t.getProtectedBinary=function(e){if(e.protectedValue)return e.protectedValue;const t=e.textContent,r=e.getAttribute(o.Attr.Ref);if(r)return{ref:r};if(!t)return;const s=w(e.getAttribute(o.Attr.Compressed));let i=(0,a.base64ToBytes)(t);return s&&(i=(0,n.gunzipSync)(i)),(0,a.arrayToBuffer)(i)},t.setProtectedBinary=function(e,t){t instanceof l.ProtectedValue?(e.protectedValue=t,e.setAttribute(o.Attr.Protected,"True")):c.KdbxBinaries.isKdbxBinaryRef(t)?e.setAttribute(o.Attr.Ref,t.ref):C(e,t)},t.traverse=x,t.setProtectedValues=function(e,t){x(e,(e=>{if(w(e.getAttribute(o.Attr.Protected)))try{const r=(0,a.arrayToBuffer)((0,a.base64ToBytes)(e.textContent||""));if(r.byteLength){const n=t.getSalt(r.byteLength);e.protectedValue=new l.ProtectedValue(r,n)}}catch(t){throw new s.KdbxError(i.ErrorCodes.FileCorrupt,`bad protected value at line ${e.lineNumber}: ${t}`)}}))},t.updateProtectedValuesSalt=function(e,t){x(e,(e=>{if(w(e.getAttribute(o.Attr.Protected))&&e.protectedValue){const r=t.getSalt(e.protectedValue.byteLength);e.protectedValue.setSalt(r),e.textContent=e.protectedValue.toString()}}))},t.unprotectValues=function(e){x(e,(e=>{w(e.getAttribute(o.Attr.Protected))&&e.protectedValue&&(e.removeAttribute(o.Attr.Protected),e.setAttribute(o.Attr.ProtectedInMemPlainXml,"True"),e.textContent=e.protectedValue.getText())}))},t.protectUnprotectedValues=function(e){x(e,(e=>{w(e.getAttribute(o.Attr.ProtectedInMemPlainXml))&&e.protectedValue&&(e.removeAttribute(o.Attr.ProtectedInMemPlainXml),e.setAttribute(o.Attr.Protected,"True"),e.textContent=e.protectedValue.toString())}))},t.protectPlainValues=function(e){x(e,(e=>{w(e.getAttribute(o.Attr.ProtectedInMemPlainXml))&&(e.protectedValue=l.ProtectedValue.fromString(e.textContent||""),e.textContent=e.protectedValue.toString(),e.removeAttribute(o.Attr.ProtectedInMemPlainXml),e.setAttribute(o.Attr.Protected,"True"))}))}},349:e=>{e.exports=t},744:t=>{t.exports=e},547:(e,t,r)=>{var n=r(733),s=Uint8Array,i=Uint16Array,o=Uint32Array,a=new s([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),d=new s([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),h=new s([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),l=function(e,t){for(var r=new i(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];var s=new o(r[30]);for(n=1;n<30;++n)for(var a=r[n];a<r[n+1];++a)s[a]=a-r[n]<<5|n;return[r,s]},c=l(a,2),u=c[0],f=c[1];u[28]=258,f[258]=28;for(var m=l(d,0),y=m[0],p=m[1],g=new i(32768),b=0;b<32768;++b){var v=(43690&b)>>>1|(21845&b)<<1;v=(61680&(v=(52428&v)>>>2|(13107&v)<<2))>>>4|(3855&v)<<4,g[b]=((65280&v)>>>8|(255&v)<<8)>>>1}var C=function(e,t,r){for(var n=e.length,s=0,o=new i(t);s<n;++s)++o[e[s]-1];var a,d=new i(t);for(s=0;s<t;++s)d[s]=d[s-1]+o[s-1]<<1;if(r){a=new i(1<<t);var h=15-t;for(s=0;s<n;++s)if(e[s])for(var l=s<<4|e[s],c=t-e[s],u=d[e[s]-1]++<<c,f=u|(1<<c)-1;u<=f;++u)a[g[u]>>>h]=l}else for(a=new i(n),s=0;s<n;++s)e[s]&&(a[s]=g[d[e[s]-1]++]>>>15-e[s]);return a},w=new s(288);for(b=0;b<144;++b)w[b]=8;for(b=144;b<256;++b)w[b]=9;for(b=256;b<280;++b)w[b]=7;for(b=280;b<288;++b)w[b]=8;var x=new s(32);for(b=0;b<32;++b)x[b]=5;var E=C(w,9,0),k=C(w,9,1),B=C(x,5,0),T=C(x,5,1),K=function(e){for(var t=e[0],r=1;r<e.length;++r)e[r]>t&&(t=e[r]);return t},S=function(e,t,r){var n=t/8|0;return(e[n]|e[n+1]<<8)>>(7&t)&r},I=function(e,t){var r=t/8|0;return(e[r]|e[r+1]<<8|e[r+2]<<16)>>(7&t)},_=function(e){return(e+7)/8|0},U=function(e,t,r){(null==t||t<0)&&(t=0),(null==r||r>e.length)&&(r=e.length);var n=new(e instanceof i?i:e instanceof o?o:s)(r-t);return n.set(e.subarray(t,r)),n};t.FlateErrorCode={UnexpectedEOF:0,InvalidBlockType:1,InvalidLengthLiteral:2,InvalidDistance:3,StreamFinished:4,NoStreamHandler:5,InvalidHeader:6,NoCallback:7,InvalidUTF8:8,ExtraFieldTooLong:9,InvalidDate:10,FilenameTooLong:11,StreamFinishing:12,InvalidZipData:13,UnknownCompressionMethod:14};var A=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],D=function(e,t,r){var n=new Error(t||A[e]);if(n.code=e,Error.captureStackTrace&&Error.captureStackTrace(n,D),!r)throw n;return n},P=function(e,t,r){var n=e.length;if(!n||r&&r.f&&!r.l)return t||new s(0);var i=!t||r,o=!r||r.i;r||(r={}),t||(t=new s(3*n));var l=function(e){var r=t.length;if(e>r){var n=new s(Math.max(2*r,e));n.set(t),t=n}},c=r.f||0,f=r.p||0,m=r.b||0,p=r.l,g=r.d,b=r.m,v=r.n,w=8*n;do{if(!p){c=S(e,f,1);var x=S(e,f+1,3);if(f+=3,!x){var E=e[(G=_(f)+4)-4]|e[G-3]<<8,B=G+E;if(B>n){o&&D(0);break}i&&l(m+E),t.set(e.subarray(G,B),m),r.b=m+=E,r.p=f=8*B,r.f=c;continue}if(1==x)p=k,g=T,b=9,v=5;else if(2==x){var A=S(e,f,31)+257,P=S(e,f+10,15)+4,M=A+S(e,f+5,31)+1;f+=14;for(var N=new s(M),V=new s(19),F=0;F<P;++F)V[h[F]]=S(e,f+3*F,7);f+=3*P;var H=K(V),j=(1<<H)-1,O=C(V,H,1);for(F=0;F<M;){var G,L=O[S(e,f,j)];if(f+=15&L,(G=L>>>4)<16)N[F++]=G;else{var z=0,R=0;for(16==G?(R=3+S(e,f,3),f+=2,z=N[F-1]):17==G?(R=3+S(e,f,7),f+=3):18==G&&(R=11+S(e,f,127),f+=7);R--;)N[F++]=z}}var W=N.subarray(0,A),X=N.subarray(A);b=K(W),v=K(X),p=C(W,b,1),g=C(X,v,1)}else D(1);if(f>w){o&&D(0);break}}i&&l(m+131072);for(var q=(1<<b)-1,$=(1<<v)-1,Z=f;;Z=f){var Q=(z=p[I(e,f)&q])>>>4;if((f+=15&z)>w){o&&D(0);break}if(z||D(2),Q<256)t[m++]=Q;else{if(256==Q){Z=f,p=null;break}var J=Q-254;if(Q>264){var Y=a[F=Q-257];J=S(e,f,(1<<Y)-1)+u[F],f+=Y}var ee=g[I(e,f)&$],te=ee>>>4;ee||D(3),f+=15&ee;X=y[te];if(te>3){Y=d[te];X+=I(e,f)&(1<<Y)-1,f+=Y}if(f>w){o&&D(0);break}i&&l(m+131072);for(var re=m+J;m<re;m+=4)t[m]=t[m-X],t[m+1]=t[m+1-X],t[m+2]=t[m+2-X],t[m+3]=t[m+3-X];m=re}}r.l=p,r.p=Z,r.b=m,r.f=c,p&&(c=1,r.m=b,r.d=g,r.n=v)}while(!c);return m==t.length?t:U(t,0,m)},M=function(e,t,r){r<<=7&t;var n=t/8|0;e[n]|=r,e[n+1]|=r>>>8},N=function(e,t,r){r<<=7&t;var n=t/8|0;e[n]|=r,e[n+1]|=r>>>8,e[n+2]|=r>>>16},V=function(e,t){for(var r=[],n=0;n<e.length;++n)e[n]&&r.push({s:n,f:e[n]});var o=r.length,a=r.slice();if(!o)return[z,0];if(1==o){var d=new s(r[0].s+1);return d[r[0].s]=1,[d,1]}r.sort((function(e,t){return e.f-t.f})),r.push({s:-1,f:25001});var h=r[0],l=r[1],c=0,u=1,f=2;for(r[0]={s:-1,f:h.f+l.f,l:h,r:l};u!=o-1;)h=r[r[c].f<r[f].f?c++:f++],l=r[c!=u&&r[c].f<r[f].f?c++:f++],r[u++]={s:-1,f:h.f+l.f,l:h,r:l};var m=a[0].s;for(n=1;n<o;++n)a[n].s>m&&(m=a[n].s);var y=new i(m+1),p=F(r[u-1],y,0);if(p>t){n=0;var g=0,b=p-t,v=1<<b;for(a.sort((function(e,t){return y[t.s]-y[e.s]||e.f-t.f}));n<o;++n){var C=a[n].s;if(!(y[C]>t))break;g+=v-(1<<p-y[C]),y[C]=t}for(g>>>=b;g>0;){var w=a[n].s;y[w]<t?g-=1<<t-y[w]++-1:++n}for(;n>=0&&g;--n){var x=a[n].s;y[x]==t&&(--y[x],++g)}p=t}return[new s(y),p]},F=function(e,t,r){return-1==e.s?Math.max(F(e.l,t,r+1),F(e.r,t,r+1)):t[e.s]=r},H=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new i(++t),n=0,s=e[0],o=1,a=function(e){r[n++]=e},d=1;d<=t;++d)if(e[d]==s&&d!=t)++o;else{if(!s&&o>2){for(;o>138;o-=138)a(32754);o>2&&(a(o>10?o-11<<5|28690:o-3<<5|12305),o=0)}else if(o>3){for(a(s),--o;o>6;o-=6)a(8304);o>2&&(a(o-3<<5|8208),o=0)}for(;o--;)a(s);o=1,s=e[d]}return[r.subarray(0,n),t]},j=function(e,t){for(var r=0,n=0;n<t.length;++n)r+=e[n]*t[n];return r},O=function(e,t,r){var n=r.length,s=_(t+2);e[s]=255&n,e[s+1]=n>>>8,e[s+2]=255^e[s],e[s+3]=255^e[s+1];for(var i=0;i<n;++i)e[s+i+4]=r[i];return 8*(s+4+n)},G=function(e,t,r,n,s,o,l,c,u,f,m){M(t,m++,r),++s[256];for(var y=V(s,15),p=y[0],g=y[1],b=V(o,15),v=b[0],k=b[1],T=H(p),K=T[0],S=T[1],I=H(v),_=I[0],U=I[1],A=new i(19),D=0;D<K.length;++D)A[31&K[D]]++;for(D=0;D<_.length;++D)A[31&_[D]]++;for(var P=V(A,7),F=P[0],G=P[1],L=19;L>4&&!F[h[L-1]];--L);var z,R,W,X,q=f+5<<3,$=j(s,w)+j(o,x)+l,Z=j(s,p)+j(o,v)+l+14+3*L+j(A,F)+(2*A[16]+3*A[17]+7*A[18]);if(q<=$&&q<=Z)return O(t,m,e.subarray(u,u+f));if(M(t,m,1+(Z<$)),m+=2,Z<$){z=C(p,g,0),R=p,W=C(v,k,0),X=v;var Q=C(F,G,0);M(t,m,S-257),M(t,m+5,U-1),M(t,m+10,L-4),m+=14;for(D=0;D<L;++D)M(t,m+3*D,F[h[D]]);m+=3*L;for(var J=[K,_],Y=0;Y<2;++Y){var ee=J[Y];for(D=0;D<ee.length;++D){var te=31&ee[D];M(t,m,Q[te]),m+=F[te],te>15&&(M(t,m,ee[D]>>>5&127),m+=ee[D]>>>12)}}}else z=E,R=w,W=B,X=x;for(D=0;D<c;++D)if(n[D]>255){te=n[D]>>>18&31;N(t,m,z[te+257]),m+=R[te+257],te>7&&(M(t,m,n[D]>>>23&31),m+=a[te]);var re=31&n[D];N(t,m,W[re]),m+=X[re],re>3&&(N(t,m,n[D]>>>5&8191),m+=d[re])}else N(t,m,z[n[D]]),m+=R[n[D]];return N(t,m,z[256]),m+R[256]},L=new o([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),z=new s(0),R=function(e,t,r,n,h,l){var c=e.length,u=new s(n+c+5*(1+Math.ceil(c/7e3))+h),m=u.subarray(n,u.length-h),y=0;if(!t||c<8)for(var g=0;g<=c;g+=65535){var b=g+65535;b<c?y=O(m,y,e.subarray(g,b)):(m[g]=l,y=O(m,y,e.subarray(g,c)))}else{for(var v=L[t-1],C=v>>>13,w=8191&v,x=(1<<r)-1,E=new i(32768),k=new i(x+1),B=Math.ceil(r/3),T=2*B,K=function(t){return(e[t]^e[t+1]<<B^e[t+2]<<T)&x},S=new o(25e3),I=new i(288),A=new i(32),D=0,P=0,M=(g=0,0),N=0,V=0;g<c;++g){var F=K(g),H=32767&g,j=k[F];if(E[H]=j,k[F]=H,N<=g){var R=c-g;if((D>7e3||M>24576)&&R>423){y=G(e,m,0,S,I,A,P,M,V,g-V,y),M=D=P=0,V=g;for(var W=0;W<286;++W)I[W]=0;for(W=0;W<30;++W)A[W]=0}var X=2,q=0,$=w,Z=H-j&32767;if(R>2&&F==K(g-Z))for(var Q=Math.min(C,R)-1,J=Math.min(32767,g),Y=Math.min(258,R);Z<=J&&--$&&H!=j;){if(e[g+X]==e[g+X-Z]){for(var ee=0;ee<Y&&e[g+ee]==e[g+ee-Z];++ee);if(ee>X){if(X=ee,q=Z,ee>Q)break;var te=Math.min(Z,ee-2),re=0;for(W=0;W<te;++W){var ne=g-Z+W+32768&32767,se=ne-E[ne]+32768&32767;se>re&&(re=se,j=ne)}}}Z+=(H=j)-(j=E[H])+32768&32767}if(q){S[M++]=268435456|f[X]<<18|p[q];var ie=31&f[X],oe=31&p[q];P+=a[ie]+d[oe],++I[257+ie],++A[oe],N=g+X,++D}else S[M++]=e[g],++I[e[g]]}}y=G(e,m,l,S,I,A,P,M,V,g-V,y),!l&&7&y&&(y=O(m,y+1,z))}return U(u,0,n+_(y)+h)},W=function(){for(var e=new Int32Array(256),t=0;t<256;++t){for(var r=t,n=9;--n;)r=(1&r&&-306674912)^r>>>1;e[t]=r}return e}(),X=function(){var e=-1;return{p:function(t){for(var r=e,n=0;n<t.length;++n)r=W[255&r^t[n]]^r>>>8;e=r},d:function(){return~e}}},q=function(){var e=1,t=0;return{p:function(r){for(var n=e,s=t,i=0|r.length,o=0;o!=i;){for(var a=Math.min(o+2655,i);o<a;++o)s+=n+=r[o];n=(65535&n)+15*(n>>16),s=(65535&s)+15*(s>>16)}e=n,t=s},d:function(){return(255&(e%=65521))<<24|e>>>8<<16|(255&(t%=65521))<<8|t>>>8}}},$=function(e,t,r,n,s){return R(e,null==t.level?6:t.level,null==t.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(e.length)))):12+t.mem,r,n,!s)},Z=function(e,t){var r={};for(var n in e)r[n]=e[n];for(var n in t)r[n]=t[n];return r},Q=function(e,t,r){for(var n=e(),s=e.toString(),i=s.slice(s.indexOf("[")+1,s.lastIndexOf("]")).replace(/ /g,"").split(","),o=0;o<n.length;++o){var a=n[o],d=i[o];if("function"==typeof a){t+=";"+d+"=";var h=a.toString();if(a.prototype)if(-1!=h.indexOf("[native code]")){var l=h.indexOf(" ",8)+1;t+=h.slice(l,h.indexOf("(",l))}else for(var c in t+=h,a.prototype)t+=";"+d+".prototype."+c+"="+a.prototype[c].toString();else t+=h}else r[d]=a}return[t,r]},J=[],Y=function(e,t,r,a){var d;if(!J[r]){for(var h="",l={},c=e.length-1,u=0;u<c;++u)h=(d=Q(e[u],h,l))[0],l=d[1];J[r]=Q(e[c],h,l)}var f=Z({},J[r][1]);return n.default(J[r][0]+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+t.toString()+"}",r,f,function(e){var t=[];for(var r in e)(e[r]instanceof s||e[r]instanceof i||e[r]instanceof o)&&t.push((e[r]=new e[r].constructor(e[r])).buffer);return t}(f),a)},ee=function(){return[s,i,o,a,d,h,u,y,k,T,g,A,C,K,S,I,_,U,D,P,Ie,oe,ae]},te=function(){return[s,i,o,a,d,h,f,p,E,w,B,x,g,L,z,C,M,N,V,F,H,j,O,G,_,U,R,$,Be,oe]},re=function(){return[ye,be,me,X,W]},ne=function(){return[pe,ge]},se=function(){return[ve,me,q]},ie=function(){return[Ce]},oe=function(e){return postMessage(e,[e.buffer])},ae=function(e){return e&&e.size&&new s(e.size)},de=function(e,t,r,n,s,i){var o=Y(r,n,s,(function(e,t){o.terminate(),i(e,t)}));return o.postMessage([e,t],t.consume?[e.buffer]:[]),function(){o.terminate()}},he=function(e){return e.ondata=function(e,t){return postMessage([e,t],[e.buffer])},function(t){return e.push(t.data[0],t.data[1])}},le=function(e,t,r,n,s){var i,o=Y(e,n,s,(function(e,r){e?(o.terminate(),t.ondata.call(t,e)):(r[1]&&o.terminate(),t.ondata.call(t,e,r[0],r[1]))}));o.postMessage(r),t.push=function(e,r){t.ondata||D(5),i&&t.ondata(D(4,0,1),null,!!r),o.postMessage([e,i=r],[e.buffer])},t.terminate=function(){o.terminate()}},ce=function(e,t){return e[t]|e[t+1]<<8},ue=function(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0},fe=function(e,t){return ue(e,t)+4294967296*ue(e,t+4)},me=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},ye=function(e,t){var r=t.filename;if(e[0]=31,e[1]=139,e[2]=8,e[8]=t.level<2?4:9==t.level?2:0,e[9]=3,0!=t.mtime&&me(e,4,Math.floor(new Date(t.mtime||Date.now())/1e3)),r){e[3]=8;for(var n=0;n<=r.length;++n)e[n+10]=r.charCodeAt(n)}},pe=function(e){31==e[0]&&139==e[1]&&8==e[2]||D(6,"invalid gzip data");var t=e[3],r=10;4&t&&(r+=e[10]|2+(e[11]<<8));for(var n=(t>>3&1)+(t>>4&1);n>0;n-=!e[r++]);return r+(2&t)},ge=function(e){var t=e.length;return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0},be=function(e){return 10+(e.filename&&e.filename.length+1||0)},ve=function(e,t){var r=t.level,n=0==r?0:r<6?1:9==r?3:2;e[0]=120,e[1]=n<<6|(n?32-2*n:1)},Ce=function(e){(8!=(15&e[0])||e[0]>>>4>7||(e[0]<<8|e[1])%31)&&D(6,"invalid zlib data"),32&e[1]&&D(6,"invalid zlib data: preset dictionaries not supported")};function we(e,t){return t||"function"!=typeof e||(t=e,e={}),this.ondata=t,e}var xe=function(){function e(e,t){t||"function"!=typeof e||(t=e,e={}),this.ondata=t,this.o=e||{}}return e.prototype.p=function(e,t){this.ondata($(e,this.o,0,0,!t),t)},e.prototype.push=function(e,t){this.ondata||D(5),this.d&&D(4),this.d=t,this.p(e,t||!1)},e}();t.Deflate=xe;var Ee=function(){return function(e,t){le([te,function(){return[he,xe]}],this,we.call(this,e,t),(function(e){var t=new xe(e.data);onmessage=he(t)}),6)}}();function ke(e,t,r){return r||(r=t,t={}),"function"!=typeof r&&D(7),de(e,t,[te],(function(e){return oe(Be(e.data[0],e.data[1]))}),0,r)}function Be(e,t){return $(e,t||{},0,0)}t.AsyncDeflate=Ee,t.deflate=ke,t.deflateSync=Be;var Te=function(){function e(e){this.s={},this.p=new s(0),this.ondata=e}return e.prototype.e=function(e){this.ondata||D(5),this.d&&D(4);var t=this.p.length,r=new s(t+e.length);r.set(this.p),r.set(e,t),this.p=r},e.prototype.c=function(e){this.d=this.s.i=e||!1;var t=this.s.b,r=P(this.p,this.o,this.s);this.ondata(U(r,t,this.s.b),this.d),this.o=U(r,this.s.b-32768),this.s.b=this.o.length,this.p=U(this.p,this.s.p/8|0),this.s.p&=7},e.prototype.push=function(e,t){this.e(e),this.c(t)},e}();t.Inflate=Te;var Ke=function(){return function(e){this.ondata=e,le([ee,function(){return[he,Te]}],this,0,(function(){var e=new Te;onmessage=he(e)}),7)}}();function Se(e,t,r){return r||(r=t,t={}),"function"!=typeof r&&D(7),de(e,t,[ee],(function(e){return oe(Ie(e.data[0],ae(e.data[1])))}),1,r)}function Ie(e,t){return P(e,t)}t.AsyncInflate=Ke,t.inflate=Se,t.inflateSync=Ie;var _e=function(){function e(e,t){this.c=X(),this.l=0,this.v=1,xe.call(this,e,t)}return e.prototype.push=function(e,t){xe.prototype.push.call(this,e,t)},e.prototype.p=function(e,t){this.c.p(e),this.l+=e.length;var r=$(e,this.o,this.v&&be(this.o),t&&8,!t);this.v&&(ye(r,this.o),this.v=0),t&&(me(r,r.length-8,this.c.d()),me(r,r.length-4,this.l)),this.ondata(r,t)},e}();t.Gzip=_e,t.Compress=_e;var Ue=function(){return function(e,t){le([te,re,function(){return[he,xe,_e]}],this,we.call(this,e,t),(function(e){var t=new _e(e.data);onmessage=he(t)}),8)}}();function Ae(e,t,r){return r||(r=t,t={}),"function"!=typeof r&&D(7),de(e,t,[te,re,function(){return[De]}],(function(e){return oe(De(e.data[0],e.data[1]))}),2,r)}function De(e,t){t||(t={});var r=X(),n=e.length;r.p(e);var s=$(e,t,be(t),8),i=s.length;return ye(s,t),me(s,i-8,r.d()),me(s,i-4,n),s}t.AsyncGzip=Ue,t.AsyncCompress=Ue,t.gzip=Ae,t.compress=Ae,t.gzipSync=De,t.compressSync=De;var Pe=function(){function e(e){this.v=1,Te.call(this,e)}return e.prototype.push=function(e,t){if(Te.prototype.e.call(this,e),this.v){var r=this.p.length>3?pe(this.p):4;if(r>=this.p.length&&!t)return;this.p=this.p.subarray(r),this.v=0}t&&(this.p.length<8&&D(6,"invalid gzip data"),this.p=this.p.subarray(0,-8)),Te.prototype.c.call(this,t)},e}();t.Gunzip=Pe;var Me=function(){return function(e){this.ondata=e,le([ee,ne,function(){return[he,Te,Pe]}],this,0,(function(){var e=new Pe;onmessage=he(e)}),9)}}();function Ne(e,t,r){return r||(r=t,t={}),"function"!=typeof r&&D(7),de(e,t,[ee,ne,function(){return[Ve]}],(function(e){return oe(Ve(e.data[0]))}),3,r)}function Ve(e,t){return P(e.subarray(pe(e),-8),t||new s(ge(e)))}t.AsyncGunzip=Me,t.gunzip=Ne,t.gunzipSync=Ve;var Fe=function(){function e(e,t){this.c=q(),this.v=1,xe.call(this,e,t)}return e.prototype.push=function(e,t){xe.prototype.push.call(this,e,t)},e.prototype.p=function(e,t){this.c.p(e);var r=$(e,this.o,this.v&&2,t&&4,!t);this.v&&(ve(r,this.o),this.v=0),t&&me(r,r.length-4,this.c.d()),this.ondata(r,t)},e}();t.Zlib=Fe;var He=function(){return function(e,t){le([te,se,function(){return[he,xe,Fe]}],this,we.call(this,e,t),(function(e){var t=new Fe(e.data);onmessage=he(t)}),10)}}();function je(e,t){t||(t={});var r=q();r.p(e);var n=$(e,t,2,4);return ve(n,t),me(n,n.length-4,r.d()),n}t.AsyncZlib=He,t.zlib=function(e,t,r){return r||(r=t,t={}),"function"!=typeof r&&D(7),de(e,t,[te,se,function(){return[je]}],(function(e){return oe(je(e.data[0],e.data[1]))}),4,r)},t.zlibSync=je;var Oe=function(){function e(e){this.v=1,Te.call(this,e)}return e.prototype.push=function(e,t){if(Te.prototype.e.call(this,e),this.v){if(this.p.length<2&&!t)return;this.p=this.p.subarray(2),this.v=0}t&&(this.p.length<4&&D(6,"invalid zlib data"),this.p=this.p.subarray(0,-4)),Te.prototype.c.call(this,t)},e}();t.Unzlib=Oe;var Ge=function(){return function(e){this.ondata=e,le([ee,ie,function(){return[he,Te,Oe]}],this,0,(function(){var e=new Oe;onmessage=he(e)}),11)}}();function Le(e,t,r){return r||(r=t,t={}),"function"!=typeof r&&D(7),de(e,t,[ee,ie,function(){return[ze]}],(function(e){return oe(ze(e.data[0],ae(e.data[1])))}),5,r)}function ze(e,t){return P((Ce(e),e.subarray(2,-4)),t)}t.AsyncUnzlib=Ge,t.unzlib=Le,t.unzlibSync=ze;var Re=function(){function e(e){this.G=Pe,this.I=Te,this.Z=Oe,this.ondata=e}return e.prototype.push=function(e,t){if(this.ondata||D(5),this.s)this.s.push(e,t);else{if(this.p&&this.p.length){var r=new s(this.p.length+e.length);r.set(this.p),r.set(e,this.p.length)}else this.p=e;if(this.p.length>2){var n=this,i=function(){n.ondata.apply(n,arguments)};this.s=31==this.p[0]&&139==this.p[1]&&8==this.p[2]?new this.G(i):8!=(15&this.p[0])||this.p[0]>>4>7||(this.p[0]<<8|this.p[1])%31?new this.I(i):new this.Z(i),this.s.push(this.p,t),this.p=null}}},e}();t.Decompress=Re;var We=function(){function e(e){this.G=Me,this.I=Ke,this.Z=Ge,this.ondata=e}return e.prototype.push=function(e,t){Re.prototype.push.call(this,e,t)},e}();t.AsyncDecompress=We,t.decompress=function(e,t,r){return r||(r=t,t={}),"function"!=typeof r&&D(7),31==e[0]&&139==e[1]&&8==e[2]?Ne(e,t,r):8!=(15&e[0])||e[0]>>4>7||(e[0]<<8|e[1])%31?Se(e,t,r):Le(e,t,r)},t.decompressSync=function(e,t){return 31==e[0]&&139==e[1]&&8==e[2]?Ve(e,t):8!=(15&e[0])||e[0]>>4>7||(e[0]<<8|e[1])%31?Ie(e,t):ze(e,t)};var Xe=function(e,t,r,n){for(var i in e){var o=e[i],a=t+i;o instanceof s?r[a]=[o,n]:Array.isArray(o)?r[a]=[o[0],Z(n,o[1])]:Xe(o,a+"/",r,n)}},qe="undefined"!=typeof TextEncoder&&new TextEncoder,$e="undefined"!=typeof TextDecoder&&new TextDecoder,Ze=0;try{$e.decode(z,{stream:!0}),Ze=1}catch(e){}var Qe=function(e){for(var t="",r=0;;){var n=e[r++],s=(n>127)+(n>223)+(n>239);if(r+s>e.length)return[t,U(e,r-1)];s?3==s?(n=((15&n)<<18|(63&e[r++])<<12|(63&e[r++])<<6|63&e[r++])-65536,t+=String.fromCharCode(55296|n>>10,56320|1023&n)):t+=1&s?String.fromCharCode((31&n)<<6|63&e[r++]):String.fromCharCode((15&n)<<12|(63&e[r++])<<6|63&e[r++]):t+=String.fromCharCode(n)}},Je=function(){function e(e){this.ondata=e,Ze?this.t=new TextDecoder:this.p=z}return e.prototype.push=function(e,t){if(this.ondata||D(5),t=!!t,this.t)return this.ondata(this.t.decode(e,{stream:!0}),t),void(t&&(this.t.decode().length&&D(8),this.t=null));this.p||D(4);var r=new s(this.p.length+e.length);r.set(this.p),r.set(e,this.p.length);var n=Qe(r),i=n[0],o=n[1];t?(o.length&&D(8),this.p=null):this.p=o,this.ondata(i,t)},e}();t.DecodeUTF8=Je;var Ye=function(){function e(e){this.ondata=e}return e.prototype.push=function(e,t){this.ondata||D(5),this.d&&D(4),this.ondata(et(e),this.d=t||!1)},e}();function et(e,t){if(t){for(var r=new s(e.length),n=0;n<e.length;++n)r[n]=e.charCodeAt(n);return r}if(qe)return qe.encode(e);var i=e.length,o=new s(e.length+(e.length>>1)),a=0,d=function(e){o[a++]=e};for(n=0;n<i;++n){if(a+5>o.length){var h=new s(a+8+(i-n<<1));h.set(o),o=h}var l=e.charCodeAt(n);l<128||t?d(l):l<2048?(d(192|l>>6),d(128|63&l)):l>55295&&l<57344?(d(240|(l=65536+(1047552&l)|1023&e.charCodeAt(++n))>>18),d(128|l>>12&63),d(128|l>>6&63),d(128|63&l)):(d(224|l>>12),d(128|l>>6&63),d(128|63&l))}return U(o,0,a)}function tt(e,t){if(t){for(var r="",n=0;n<e.length;n+=16384)r+=String.fromCharCode.apply(null,e.subarray(n,n+16384));return r}if($e)return $e.decode(e);var s=Qe(e),i=s[0];return s[1].length&&D(8),i}t.EncodeUTF8=Ye,t.strToU8=et,t.strFromU8=tt;var rt=function(e){return 1==e?3:e<6?2:9==e?1:0},nt=function(e,t){return t+30+ce(e,t+26)+ce(e,t+28)},st=function(e,t,r){var n=ce(e,t+28),s=tt(e.subarray(t+46,t+46+n),!(2048&ce(e,t+8))),i=t+46+n,o=ue(e,t+20),a=r&&4294967295==o?it(e,i):[o,ue(e,t+24),ue(e,t+42)],d=a[0],h=a[1],l=a[2];return[ce(e,t+10),d,h,s,i+ce(e,t+30)+ce(e,t+32),l]},it=function(e,t){for(;1!=ce(e,t);t+=4+ce(e,t+2));return[fe(e,t+12),fe(e,t+4),fe(e,t+20)]},ot=function(e){var t=0;if(e)for(var r in e){var n=e[r].length;n>65535&&D(9),t+=n+4}return t},at=function(e,t,r,n,s,i,o,a){var d=n.length,h=r.extra,l=a&&a.length,c=ot(h);me(e,t,null!=o?33639248:67324752),t+=4,null!=o&&(e[t++]=20,e[t++]=r.os),e[t]=20,t+=2,e[t++]=r.flag<<1|(null==i&&8),e[t++]=s&&8,e[t++]=255&r.compression,e[t++]=r.compression>>8;var u=new Date(null==r.mtime?Date.now():r.mtime),f=u.getFullYear()-1980;if((f<0||f>119)&&D(10),me(e,t,f<<25|u.getMonth()+1<<21|u.getDate()<<16|u.getHours()<<11|u.getMinutes()<<5|u.getSeconds()>>>1),t+=4,null!=i&&(me(e,t,r.crc),me(e,t+4,i),me(e,t+8,r.size)),me(e,t+12,d),me(e,t+14,c),t+=16,null!=o&&(me(e,t,l),me(e,t+6,r.attrs),me(e,t+10,o),t+=14),e.set(n,t),t+=d,c)for(var m in h){var y=h[m],p=y.length;me(e,t,+m),me(e,t+2,p),e.set(y,t+4),t+=4+p}return l&&(e.set(a,t),t+=l),t},dt=function(e,t,r,n,s){me(e,t,101010256),me(e,t+8,r),me(e,t+10,r),me(e,t+12,n),me(e,t+16,s)},ht=function(){function e(e){this.filename=e,this.c=X(),this.size=0,this.compression=0}return e.prototype.process=function(e,t){this.ondata(null,e,t)},e.prototype.push=function(e,t){this.ondata||D(5),this.c.p(e),this.size+=e.length,t&&(this.crc=this.c.d()),this.process(e,t||!1)},e}();t.ZipPassThrough=ht;var lt=function(){function e(e,t){var r=this;t||(t={}),ht.call(this,e),this.d=new xe(t,(function(e,t){r.ondata(null,e,t)})),this.compression=8,this.flag=rt(t.level)}return e.prototype.process=function(e,t){try{this.d.push(e,t)}catch(e){this.ondata(e,null,t)}},e.prototype.push=function(e,t){ht.prototype.push.call(this,e,t)},e}();t.ZipDeflate=lt;var ct=function(){function e(e,t){var r=this;t||(t={}),ht.call(this,e),this.d=new Ee(t,(function(e,t,n){r.ondata(e,t,n)})),this.compression=8,this.flag=rt(t.level),this.terminate=this.d.terminate}return e.prototype.process=function(e,t){this.d.push(e,t)},e.prototype.push=function(e,t){ht.prototype.push.call(this,e,t)},e}();t.AsyncZipDeflate=ct;var ut=function(){function e(e){this.ondata=e,this.u=[],this.d=1}return e.prototype.add=function(e){var t=this;if(this.ondata||D(5),2&this.d)this.ondata(D(4+8*(1&this.d),0,1),null,!1);else{var r=et(e.filename),n=r.length,i=e.comment,o=i&&et(i),a=n!=e.filename.length||o&&i.length!=o.length,d=n+ot(e.extra)+30;n>65535&&this.ondata(D(11,0,1),null,!1);var h=new s(d);at(h,0,e,r,a);var l=[h],c=function(){for(var e=0,r=l;e<r.length;e++){var n=r[e];t.ondata(null,n,!1)}l=[]},u=this.d;this.d=0;var f=this.u.length,m=Z(e,{f:r,u:a,o,t:function(){e.terminate&&e.terminate()},r:function(){if(c(),u){var e=t.u[f+1];e?e.r():t.d=1}u=1}}),y=0;e.ondata=function(r,n,i){if(r)t.ondata(r,n,i),t.terminate();else if(y+=n.length,l.push(n),i){var o=new s(16);me(o,0,134695760),me(o,4,e.crc),me(o,8,y),me(o,12,e.size),l.push(o),m.c=y,m.b=d+y+16,m.crc=e.crc,m.size=e.size,u&&m.r(),u=1}else u&&c()},this.u.push(m)}},e.prototype.end=function(){var e=this;2&this.d?this.ondata(D(4+8*(1&this.d),0,1),null,!0):(this.d?this.e():this.u.push({r:function(){1&e.d&&(e.u.splice(-1,1),e.e())},t:function(){}}),this.d=3)},e.prototype.e=function(){for(var e=0,t=0,r=0,n=0,i=this.u;n<i.length;n++){r+=46+(h=i[n]).f.length+ot(h.extra)+(h.o?h.o.length:0)}for(var o=new s(r+22),a=0,d=this.u;a<d.length;a++){var h=d[a];at(o,e,h,h.f,h.u,h.c,t,h.o),e+=46+h.f.length+ot(h.extra)+(h.o?h.o.length:0),t+=h.b}dt(o,e,this.u.length,r,t),this.ondata(null,o,!0),this.d=2},e.prototype.terminate=function(){for(var e=0,t=this.u;e<t.length;e++){t[e].t()}this.d=2},e}();t.Zip=ut,t.zip=function(e,t,r){r||(r=t,t={}),"function"!=typeof r&&D(7);var n={};Xe(e,"",n,t);var i=Object.keys(n),o=i.length,a=0,d=0,h=o,l=new Array(o),c=[],u=function(){for(var e=0;e<c.length;++e)c[e]()},f=function(e,t){gt((function(){r(e,t)}))};gt((function(){f=r}));var m=function(){var e=new s(d+22),t=a,r=d-a;d=0;for(var n=0;n<h;++n){var i=l[n];try{var o=i.c.length;at(e,d,i,i.f,i.u,o);var c=30+i.f.length+ot(i.extra),u=d+c;e.set(i.c,u),at(e,a,i,i.f,i.u,o,d,i.m),a+=16+c+(i.m?i.m.length:0),d=u+o}catch(e){return f(e,null)}}dt(e,a,l.length,r,t),f(null,e)};o||m();for(var y=function(e){var t=i[e],r=n[t],s=r[0],h=r[1],y=X(),p=s.length;y.p(s);var g=et(t),b=g.length,v=h.comment,C=v&&et(v),w=C&&C.length,x=ot(h.extra),E=0==h.level?0:8,k=function(r,n){if(r)u(),f(r,null);else{var s=n.length;l[e]=Z(h,{size:p,crc:y.d(),c:n,f:g,m:C,u:b!=t.length||C&&v.length!=w,compression:E}),a+=30+b+x+s,d+=76+2*(b+x)+(w||0)+s,--o||m()}};if(b>65535&&k(D(11,0,1),null),E)if(p<16e4)try{k(null,Be(s,h))}catch(e){k(e,null)}else c.push(ke(s,h,k));else k(null,s)},p=0;p<h;++p)y(p);return u},t.zipSync=function(e,t){t||(t={});var r={},n=[];Xe(e,"",r,t);var i=0,o=0;for(var a in r){var d=r[a],h=d[0],l=d[1],c=0==l.level?0:8,u=(k=et(a)).length,f=l.comment,m=f&&et(f),y=m&&m.length,p=ot(l.extra);u>65535&&D(11);var g=c?Be(h,l):h,b=g.length,v=X();v.p(h),n.push(Z(l,{size:h.length,crc:v.d(),c:g,f:k,m,u:u!=a.length||m&&f.length!=y,o:i,compression:c})),i+=30+u+p+b,o+=76+2*(u+p)+(y||0)+b}for(var C=new s(o+22),w=i,x=o-i,E=0;E<n.length;++E){var k=n[E];at(C,k.o,k,k.f,k.u,k.c.length);var B=30+k.f.length+ot(k.extra);C.set(k.c,k.o+B),at(C,i,k,k.f,k.u,k.c.length,k.o,k.m),i+=16+B+(k.m?k.m.length:0)}return dt(C,i,n.length,x,w),C};var ft=function(){function e(){}return e.prototype.push=function(e,t){this.ondata(null,e,t)},e.compression=0,e}();t.UnzipPassThrough=ft;var mt=function(){function e(){var e=this;this.i=new Te((function(t,r){e.ondata(null,t,r)}))}return e.prototype.push=function(e,t){try{this.i.push(e,t)}catch(e){this.ondata(e,null,t)}},e.compression=8,e}();t.UnzipInflate=mt;var yt=function(){function e(e,t){var r=this;t<32e4?this.i=new Te((function(e,t){r.ondata(null,e,t)})):(this.i=new Ke((function(e,t,n){r.ondata(e,t,n)})),this.terminate=this.i.terminate)}return e.prototype.push=function(e,t){this.i.terminate&&(e=U(e,0)),this.i.push(e,t)},e.compression=8,e}();t.AsyncUnzipInflate=yt;var pt=function(){function e(e){this.onfile=e,this.k=[],this.o={0:ft},this.p=z}return e.prototype.push=function(e,t){var r=this;if(this.onfile||D(5),this.p||D(4),this.c>0){var n=Math.min(this.c,e.length),i=e.subarray(0,n);if(this.c-=n,this.d?this.d.push(i,!this.c):this.k[0].push(i),(e=e.subarray(n)).length)return this.push(e,t)}else{var o=0,a=0,d=void 0,h=void 0;this.p.length?e.length?((h=new s(this.p.length+e.length)).set(this.p),h.set(e,this.p.length)):h=this.p:h=e;for(var l=h.length,c=this.c,u=c&&this.d,f=function(){var e,t=ue(h,a);if(67324752==t){o=1,d=a,m.d=null,m.c=0;var n=ce(h,a+6),s=ce(h,a+8),i=2048&n,u=8&n,f=ce(h,a+26),y=ce(h,a+28);if(l>a+30+f+y){var p=[];m.k.unshift(p),o=2;var g,b=ue(h,a+18),v=ue(h,a+22),C=tt(h.subarray(a+30,a+=30+f),!i);4294967295==b?(e=u?[-2]:it(h,a),b=e[0],v=e[1]):u&&(b=-1),a+=y,m.c=b;var w={name:C,compression:s,start:function(){if(w.ondata||D(5),b){var e=r.o[s];e||w.ondata(D(14,"unknown compression type "+s,1),null,!1),(g=b<0?new e(C):new e(C,b,v)).ondata=function(e,t,r){w.ondata(e,t,r)};for(var t=0,n=p;t<n.length;t++){var i=n[t];g.push(i,!1)}r.k[0]==p&&r.c?r.d=g:g.push(z,!0)}else w.ondata(null,z,!0)},terminate:function(){g&&g.terminate&&g.terminate()}};b>=0&&(w.size=b,w.originalSize=v),m.onfile(w)}return"break"}if(c){if(134695760==t)return d=a+=12+(-2==c&&8),o=3,m.c=0,"break";if(33639248==t)return d=a-=4,o=3,m.c=0,"break"}},m=this;a<l-4;++a){if("break"===f())break}if(this.p=z,c<0){var y=o?h.subarray(0,d-12-(-2==c&&8)-(134695760==ue(h,d-16)&&4)):h.subarray(0,a);u?u.push(y,!!o):this.k[+(2==o)].push(y)}if(2&o)return this.push(h.subarray(a),t);this.p=h.subarray(a)}t&&(this.c&&D(13),this.p=null)},e.prototype.register=function(e){this.o[e.compression]=e},e}();t.Unzip=pt;var gt="function"==typeof queueMicrotask?queueMicrotask:"function"==typeof setTimeout?setTimeout:function(e){e()};t.unzip=function(e,t,r){r||(r=t,t={}),"function"!=typeof r&&D(7);var n=[],i=function(){for(var e=0;e<n.length;++e)n[e]()},o={},a=function(e,t){gt((function(){r(e,t)}))};gt((function(){a=r}));for(var d=e.length-22;101010256!=ue(e,d);--d)if(!d||e.length-d>65558)return a(D(13,0,1),null),i;var h=ce(e,d+8);if(h){var l=h,c=ue(e,d+16),u=4294967295==c;if(u){if(d=ue(e,d-12),101075792!=ue(e,d))return a(D(13,0,1),null),i;l=h=ue(e,d+32),c=ue(e,d+48)}for(var f=t&&t.filter,m=function(t){var r=st(e,c,u),d=r[0],l=r[1],m=r[2],y=r[3],p=r[4],g=r[5],b=nt(e,g);c=p;var v=function(e,t){e?(i(),a(e,null)):(t&&(o[y]=t),--h||a(null,o))};if(!f||f({name:y,size:l,originalSize:m,compression:d}))if(d)if(8==d){var C=e.subarray(b,b+l);if(l<32e4)try{v(null,Ie(C,new s(m)))}catch(e){v(e,null)}else n.push(Se(C,{size:m},v))}else v(D(14,"unknown compression type "+d,1),null);else v(null,U(e,b,b+l));else v(null,null)},y=0;y<l;++y)m()}else a(null,{});return i},t.unzipSync=function(e,t){for(var r={},n=e.length-22;101010256!=ue(e,n);--n)(!n||e.length-n>65558)&&D(13);var i=ce(e,n+8);if(!i)return{};var o=ue(e,n+16),a=4294967295==o;a&&(n=ue(e,n-12),101075792!=ue(e,n)&&D(13),i=ue(e,n+32),o=ue(e,n+48));for(var d=t&&t.filter,h=0;h<i;++h){var l=st(e,o,a),c=l[0],u=l[1],f=l[2],m=l[3],y=l[4],p=l[5],g=nt(e,p);o=y,d&&!d({name:m,size:u,originalSize:f,compression:c})||(c?8==c?r[m]=Ie(e.subarray(g,g+u),new s(f)):D(14,"unknown compression type "+c):r[m]=U(e,g,g+u))}return r}},733:(e,t)=>{var r={};t.default=function(e,t,n,s,i){var o=new Worker(r[t]||(r[t]=URL.createObjectURL(new Blob([e+';addEventListener("error",function(e){e=e.error;postMessage({$e$:[e.message,e.code,e.stack]})})'],{type:"text/javascript"}))));return o.onmessage=function(e){var t=e.data,r=t.$e$;if(r){var n=new Error(r[0]);n.code=r[1],n.stack=r[2],i(n,null)}else i(null,t)},o.postMessage(n,s),o}}},n={};function s(e){var t=n[e];if(void 0!==t)return t.exports;var i=n[e]={exports:{}};return r[e](i,i.exports,s),i.exports}s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}();var i={};return(()=>{var e=i;Object.defineProperty(e,"__esModule",{value:!0}),e.XmlUtils=e.VarDictionary=e.Int64=e.ByteUtils=e.BinaryStream=e.KdbxUuid=e.KdbxTimes=e.KdbxMeta=e.KdbxHeader=e.KdbxGroup=e.KdbxFormat=e.KdbxEntry=e.KdbxDeletedObject=e.KdbxCustomData=e.Credentials=e.KdbxCredentials=e.KdbxContext=e.KdbxBinaries=e.Kdbx=e.KdbxError=e.XmlNames=e.Consts=e.Salsa20=e.ProtectedValue=e.ProtectSaltGenerator=e.KeyEncryptorKdf=e.KeyEncryptorAes=e.HmacBlockTransform=e.HashedBlockTransform=e.CryptoEngine=e.ChaCha20=void 0;const t=s(61);Object.defineProperty(e,"ChaCha20",{enumerable:!0,get:function(){return t.ChaCha20}});const r=s(613);e.CryptoEngine=r;const n=s(8);e.HashedBlockTransform=n;const o=s(522);e.HmacBlockTransform=o;const a=s(695);e.KeyEncryptorAes=a;const d=s(879);e.KeyEncryptorKdf=d;const h=s(328);Object.defineProperty(e,"ProtectSaltGenerator",{enumerable:!0,get:function(){return h.ProtectSaltGenerator}});const l=s(758);Object.defineProperty(e,"ProtectedValue",{enumerable:!0,get:function(){return l.ProtectedValue}});const c=s(18);Object.defineProperty(e,"Salsa20",{enumerable:!0,get:function(){return c.Salsa20}});const u=s(513);e.Consts=u;const f=s(638);e.XmlNames=f;const m=s(325);Object.defineProperty(e,"KdbxError",{enumerable:!0,get:function(){return m.KdbxError}});const y=s(131);Object.defineProperty(e,"Kdbx",{enumerable:!0,get:function(){return y.Kdbx}});const p=s(968);Object.defineProperty(e,"KdbxBinaries",{enumerable:!0,get:function(){return p.KdbxBinaries}});const g=s(497);Object.defineProperty(e,"KdbxContext",{enumerable:!0,get:function(){return g.KdbxContext}});const b=s(374);Object.defineProperty(e,"KdbxCredentials",{enumerable:!0,get:function(){return b.KdbxCredentials}}),Object.defineProperty(e,"Credentials",{enumerable:!0,get:function(){return b.KdbxCredentials}});const v=s(596);Object.defineProperty(e,"KdbxCustomData",{enumerable:!0,get:function(){return v.KdbxCustomData}});const C=s(414);Object.defineProperty(e,"KdbxDeletedObject",{enumerable:!0,get:function(){return C.KdbxDeletedObject}});const w=s(270);Object.defineProperty(e,"KdbxEntry",{enumerable:!0,get:function(){return w.KdbxEntry}});const x=s(257);Object.defineProperty(e,"KdbxFormat",{enumerable:!0,get:function(){return x.KdbxFormat}});const E=s(171);Object.defineProperty(e,"KdbxGroup",{enumerable:!0,get:function(){return E.KdbxGroup}});const k=s(447);Object.defineProperty(e,"KdbxHeader",{enumerable:!0,get:function(){return k.KdbxHeader}});const B=s(296);Object.defineProperty(e,"KdbxMeta",{enumerable:!0,get:function(){return B.KdbxMeta}});const T=s(554);Object.defineProperty(e,"KdbxTimes",{enumerable:!0,get:function(){return T.KdbxTimes}});const K=s(552);Object.defineProperty(e,"KdbxUuid",{enumerable:!0,get:function(){return K.KdbxUuid}});const S=s(909);Object.defineProperty(e,"BinaryStream",{enumerable:!0,get:function(){return S.BinaryStream}});const I=s(100);e.ByteUtils=I;const _=s(880);Object.defineProperty(e,"Int64",{enumerable:!0,get:function(){return _.Int64}});const U=s(336);Object.defineProperty(e,"VarDictionary",{enumerable:!0,get:function(){return U.VarDictionary}});const A=s(943);e.XmlUtils=A})(),i})()}));